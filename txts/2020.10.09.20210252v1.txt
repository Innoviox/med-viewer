medRxiv preprint doi: https://doi.org/10.1101/2020.10.09.20210252.this version posted October 13, 2020. The copyright holder for this preprint
    (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                        It is made available under a CC-BY-NC 4.0 International license .
      Multi-type branching and graph product theory of infectious disease outbreaks
                                                             Alexei Vazquez1, 2, ∗
                                  1
                                    Cancer Research UK Beatson Institute, Glasgow, United Kingdom
                         2
                           Institute for Cancer Sciences, University of Glasgow, Glasgow, United Kingdom
                                                           (Dated: October 9, 2020)
                 The heterogeneity of human populations is a major challenge to mathematical descriptions of
              infectious disease outbreaks. Numerical simulations are therefore deployed to account for the many
              factors influencing the disease spreading dynamics. Yet, the results from numerical simulations are
              often as complicated as the reality, leaving us with a sense of confusion about how the different
              factors account for the simulation results. Here, using a multi-type branching together with a graph
              tensor product approach, I derive a single equation for the effective reproductive number of an
              infectious disease outbreak. Using this equation I deconvolute the impact of crowd management,
              contact heterogeneity, testing, vaccination, mask use and smartphone tracing app use. This equation
              can be used to gain a basic understanding of infectious disease outbreaks and their simulations.
   Infectious disease outbreaks take place in the back-                       the case of COVID-19, contact means physical proximity
ground of a heterogenous population of susceptible in-                        for a certain amount of time. In the case of HIV con-
dividuals. A key source of heterogeneity is the variabil-                     tact means sexual intercourse, syringe-needle sharing or
ity in the number of potentially transmitting contacts.                       mother giving birth baby. Here is were the population
For airborne diseases like the ongoing COVID-19 out-                          heterogeneity starts to kick in.
break, the relevant contacts are close physical proxim-                          Some individuals may visit crowded places during a
ity for a certain amount of time. Simulations of people                       day, getting in contact with several people. Other indi-
movement within a city has shown that the number of                           viduals may work at home and get in contact mostly with
proximity contacts within a day has a broad distribution                      their house mates. With relevance to HIV or other sex-
across individuals [1]. Another source of variability are                     ually transmitted diseases, there is a broad distribution
age groups, which dictate the mixing patterns between                         in the number of sexual partners of individuals across a
children, adults and the elderly [2]. Finally, the pattern                    population [6]. I will call this contact heterogeneity. The
of adherence to intervention guidelines to manage the                         number of physical proximity contacts in a day, or the
disease introduces heterogeneity in the susceptibility of                     number of sexual partners within a year, can vary from
individuals to be infected [3].                                               zero to 100s and it is better represented by a probability
   These heterogeneities may sound too complex to be                          distribution.
handle by means of analytical descriptions, leaving us                           Individuals are also different regarding their percep-
with the choice of numerical simulations. Numerical sim-                      tion about the effectiveness of containment strategies en-
ulations are indeed the right context to introduce all                        forced or suggested by the relevant authorities. In the
kinds of parametrizations of spreading processes on het-                      context of COVID-19, face masks and smartphone trac-
erogenous populations [3–5]. Yet, we would also like to                       ing apps are not in use by all individuals. In the context
have a basic understanding of the problem under con-                          of HIV and other sexually transmitted diseases there are
sideration, albeit sacrificing numerical precision. Here I                    several sources of heterogeneity, including sexual orien-
demonstrate that a combination of multi-type branch-                          tation, condom use, drug use, among other factors. I will
ing process theory and graph tensor products allow us                         call this type heterogeneity, where a type can be any prop-
to disentangle the contributions of different factors and                     erty taking values over a discrete set of small size that
containment strategies to the outbreak dynamics.                              can have an impact on the infectious disease dynamics.
   The susceptible, infected and recovered (SIR) model                        The types are characterized by their frequency in the
is a good representation of infectious disease outbreaks                      population and the mixing patterns between individuals
when the recovery from the disease confers immunity. In                       according to type.
the case of COVID-19 it is not clear how long a person                           Another potential source of variability is the disease
remains immune to the disease after infection, but it is                      dynamics within a given individual, from the time of re-
expected to be at least of the order of months. In the SIR                    ceiving the infection to recovery. This dynamics could
model the individuals of a population can be susceptible                      be, in general, correlated with the contact or type het-
to acquire the disease, infected and as a consequence in-                     erogeneities. Here I focus on the contact and type het-
fectious (with some probability) or dead/recovered from                       erogeneity and assume that the disease dynamics within
the disease. Infected individuals can transmit the disease                    individuals is uncorrelated from the contact and type het-
to susceptible individuals when they are in contact. In                       erogeneity. In this case the disease transmission dynam-
                                                                              ics from an infected to a susceptible individual is char-
                                                                              acterized by the generating time, denoted by τ , defined
                                                                              as the interval from the time of infection of an individ-
∗ avazque1@protonmail.com                                                     ual to the time it transmit the disease to a susceptible
        NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.10.09.20210252.this version posted October 13, 2020. The copyright holder for this preprint
    (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY-NC 4.0 International license .
                                                                                                                                              2
individual. I will denote by g(τ ) the probability density                 and the probability density function of the disease trans-
function of the generating time.                                           mission times is exponential
   Using well stablished mathematics from the theory of
multi-type branching processes, I have previously calcu-                                                    1
                                                                                                 g(τ ) =        e−(α+γ)τ                    (5)
lated the expected number of infected individuals of in-                                                   α+γ
fectious disease outbreaks on heterogeneous populations
[7]. In a nutshell, the multi-type formalism replaces the                  Notice that, when the rate of becoming infectious is very
average reproductive number, an scalar, by a matrix of                     high (α  γ), disease transmission is almost certain and
reproductive numbers, making an distinction between pa-                    most disease transmissions will take place in a time scale
tient zero an any other infected individual. The average                   of the order of 1/α.
reproductive number matrix for patient zero has elements                      Under the assumptions made from (1) to (5), equation
                                                                           (3) has two different limiting behaviours depending on
                                    hβi                                    the parameter
                          Rab =          reab                       (1)
                                     γ
                                                                                                             D−1
where a and b are indexes over the types, hβi is the aver-                                              θ=                                  (6)
                                                                                                               ρ
age contact rate in the population, γ is the recovery rate,
r is the probability of infection transmission and eab is                  where ρ is the largest eigenvalue of R̃ [7]. When ρ > 1
the probability that an individual of type a reaches a                     and θ  1, then for (λ + µ)t  θ the number of new
type b individual upon contact. For infected cases other                   infectious grows exponentially according to
than patient zero one needs to take into account that the
disease spreading biases the disease transmission to in-                                            I(t) ∼ e(ρ−1)(α+γ)t                     (7)
dividuals with a higher contact rate. The patient zero
can be thought as an individual selected at random from                    In contrast, when θ  1, then for (λ + µ)t  θ the
the population. Any other infected individual will not                     number of new infectious grows as a power law with an
be selected at random, but it will be found with a prob-                   exponential cutoff
ability proportional to its contact rate: β/N hβi, where
N is the population size. Once infected, the individual                                            I(t) ∼ tD−1 e−(α+γ)t                     (8)
found by contact will engage in new contacts at a rate β.
Therefore, the average reproductive number matrix for                      These results tell us that the outbreaks dynamics is
patients other than patient zero has elements                              mostly determined by the largest eigenvalue of the re-
                                                                           productive number matrix R̃ and the maximum number
                                   hβ 2 i
                         R̃ab =           reab                      (2)    of generations D the outbreak goes through. I have al-
                                   hβiγ                                    ready made the point that a lockdown is translated into
   R gives the average number of infectious at the first                   a small value of D, leading to the manifestation of the
generation, those generated by patient zero. RR̃ gives                     power law growth with an exponential truncation [8, 9].
the average number of infections at the second generation                  According to equation (8) this behaviour persist regard-
and RR̃d−1 gives the average number of infections at the                   less of the type heterogeneity, provided θ  1. Here I
d generation. The actual time when an infected case                        will focus on the impact of heterogeneities on the largest
at generation d becomes infected equals the sum of d                       eigenvalue ρ.
generation times and it has a probability density function                    The type mixing matrix, with elements eab , can be
g ?d (t), where the symbol ? denotes convolution (g ?d =                   represented by a directed weighted graph with loops. A
R t ?(d−1)                                                                 directed edge (arc) will be drawn from type a to type b
 0
    g      (τ )g(t − τ )dτ ). Therefore, the average number
                                                                           whenever eab > 0. Loops account for the fact that in-
of new infected individuals at time t is given by (equation
                                                                           fected individuals of a given type could infect susceptible
(36) in Ref. [7])
                                                                           individuals of the same type. The arcs have weights eab ,
                     X         XD                                        indicating the probability that, starting from a type a,
            I(t) =        Na          RR̃d−1         g ?d (t)       (3)    there is a type b at the other end. Figure 1 provides ex-
                                                  ab
                      ab       d=1                                         amples of the type graphs associated with vaccination,
                                                                           mask use or smartphone use. In each case there are two
where Na is the number of patients zero of type a and D is                 types: vaccinated or not, wears mask or does not, smart-
the maximum generation, when the disease transmission                      phone tracing app user or not. The associated mixing
ends.                                                                      matrices are 2 × 2 matrices and it is straightforward to
   If infected individuals become infectious at a rate α                   calculate the largest eigenvalue. The challenge begins
and get recovered at rate γ, then the probability of dis-                  when we consider a combinations of those or other pop-
ease transmission upon contact between an infected and                     ulation stratifications at once. We would have to include
a susceptible individual is given by [7]                                   several types and deal with matrices of largest dimen-
                                      α                                    sion, making an analytical description cumbersome and
                             r=                                     (4)    prompting calculation errors.
                                   α+γ

medRxiv preprint doi: https://doi.org/10.1101/2020.10.09.20210252.this version posted October 13, 2020. The copyright holder for this preprint
   (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                        It is made available under a CC-BY-NC 4.0 International license .
                                                                                                                                              3
   Yet, if the different stratifications are not correlated                   G                        G                    G
the problem can be tackle with the use of graph ten-
                                                                                 1                        2                    3
sor products. Under the assumption of independence,
the type graph taking into account n independent pop-
ulation stratifications can be represented by the graph
tensor product of each independent stratification
               G = G(1) × G(2) × · · · × G(n)                      (9)
An example is shown in Fig. 1. In turn, the type mixing
matrix of graph G can be written as a Kronecker product                       G1 X G2 X G3
of the type mixing matrices of graphs Gi ,
                  e = e(1) × e(2) × · · · × e(n)                  (10)
Here comes the trick. The eigenvalues of the Kronecker
product of two matrixes are given by the pairwise product
of the eigenvalues of each matrix (Theorem 13.12, [10]).
An obvious corollary of this theorem if that the largest
eigenvalue of e is equal to the products of the largest
eigenvalues of the e(i) ,
                         Λ = Λ1 Λ2 · · · Λn                       (11)
where Λi denotes the largest eigenvalue of e(i) . Finally,
the largest eigenvalue of R̃ in equation (2) is given by                  FIG. 1. Type graphs for vaccination (G1 ), mask use (G2 ),
                                                                          smartphone tracing app use (G3 ) and their graph tensor prod-
                           hβ 2 i                                         uct (G1 × G2 × G3 ). In every case open circles represent in-
                     ρ=           rΛ1 Λ2 · · · Λn                 (12)
                           hβiγ                                           dividuals that are not covered by the containment strategy.
                                                                          Square are vaccinated individuals, symbols with a diagonal
   We can use equation (12) to estimate the effective-                    line are individuals that wear mask and solid symbols are in-
ness of mixed strategies to contain an infectious disease                 dividuals that use the smartphone tracing app
outbreak. To illustrate how it is done, let us consider
the case of a population where crowd management, test-
ing, vaccination, mask use and smartphone tracing apps                    Mask use is modelled by the type graph G2 in Fig. 1 and
have been deployed. Crowd management alters the dis-                      the associated type mixing matrix
tribution of β across the population and its effect can be                                            
                                                                                                        0      a1 (1 − m)
                                                                                                                          
                                                                                              (2)
represented by the trasnformation                                                            e =                                          (17)
                                                                                                        a0 m 1 − m
                          hβ 2 i       hβ 2 i
                                  →c                              (13)    where m is the fraction of individuals that wear mask,
                          hβiγ         hβiγ                               0 ≤ a1 < 1 is the attenuation of the disease transmission
where 0 ≤ c ≤ 1 is the reduction in contact heterogene-                   from a mask user to a non-user, and 0 ≤ a0 < 1 is the
ity due to the crowd management. Testing will increase                    attenuation of the disease transmission from a non-mask
the rate at with infected individuals are removed from                    user to a user. Here we have assumed that there is no
the disease transmission chain. Assuming that testing is                  disease transmission between mask users. In this case the
done at rate ξ (test reports per person per unit of time),                largest eigenvalue equals to
then the probability of disease transmission upon contact                                          p
                                                                                       1 − m + (1 − m)2 + 4m(1 − m)a0 a1
should be updated to                                                           Λ2 =                                                       (18)
                                                                                                              2
                                      α
                          r=                                      (14)    Finally, smartphone tracing app use is modelled by the
                                 α+γ+ξ
                                                                          type graph G3 in Fig. 1 and the associated type mixing
Vaccination can be modelled by the type graph G1 in                       matrix
Fig. 1 and the associated type mixing matrix                                                                          
                                                                                                             0 1−u
                                                                                                   e(3) =                                 (19)
                                                                                                             u 1−u
                                              
                         (1)       0 1−v
                       e =                                        (15)
                                   0 1−v
                                                                          where u is the fraction of individuals that use the smart-
where v is the fraction of vaccinated individuals in the                  phone tracing app. Here we have assumed that there is
population. In this case                                                  no disease transmission between smartphone app users.
                                                                          This is because, once a smartphone app user test pos-
                             Λ1 = 1 − v                           (16)    itive for the disease, any forward transmission to other

medRxiv preprint doi: https://doi.org/10.1101/2020.10.09.20210252.this version posted October 13, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                        It is made available under a CC-BY-NC 4.0 International license .
                                                                                                                                             4
          1                                                               does not.
                                                                             Now we proceed to combine the different containment
        0.8                                                               strategies. Substituting equations (13)-(20) into equation
                                                                          (12) we finally obtain
        0.6                                                                             hβ 2 i  α
    Λ                                                                             ρ=c                  (1 − v)
                                                                                        hβiγ α + γ + ξ
        0.4
                                                                                               p
                          Λ1                                                           1 − m + (1 − m)2 + 4m(1 − m)a0 a1
                                                                                     ·
                                                                                                           2
                          Λ2, αβ=0.5                                                           p
                                                                                                         2
        0.2                                                                            1 − u + (1 − u) + 4u(1 − u)
                          Λ3                                                         ·                                                    (21)
                                                                                                     2
         0
              0     0.2        0.4       0.6        0.8        1          This master equation can be used as a starting point to
                                 v, m, u                                  obtain a comprehensive understanding of how interven-
                                                                          tion strategies impact the expected reproductive number.
FIG. 2. Largest eigenvalue as a function of the relevant pa-              In the absence of contact heterogeneity (hβ 2 i = hβi2 ), an
rameter for the listed containment strategies.                            instantaneous rate of becoming infectious (α  γ) and
                                                                          no interventions (c = 1, v = 0, m = 0, u = 0, ξ = 0),
                                                                          we obtain ρ = R0 = hβi/γ, which is the basic reproduc-
smartphone tracing app users is halted. In this case the                  tive number of the standard SIR model. Due the con-
largest eigenvalue equals to                                              tact heterogeneity R0 underestimates ρ in the absence
                        p                                                 of interventions. In the present of multiple containment
                1 − u + (1 − u)2 + 4u(1 − u)                              strategies, we can use (21) to estimate the aggregate im-
           Λ3 =                                     (20)
                             2                                            pact. For example, combining a 50% of mask users with
                                                                          a 50% of smartphone tracing app users will reduce the
   Figure (2) shows the largest eigenvalue of the different               reproductive number by about a half. Add to that a 50%
containment strategies as a function of the fraction of                   vaccination and it will reduce the reproductive number
individuals subject to the intervention (vaccinated, mask                 by about a third.
user, smartphone tracing app user). It is evident that the                   In conclusion, using a multi-type branching together
largest eigenvalues associated with mask use and smart-                   with a graph tensor product approach I have derived an
phone tracing app use are concave functions of the corre-                 equation for the expected reproductive number of an in-
sponding users fraction. The latter implies that for small                fectious disease as a function of the parameters of the
user fractions there is not much reduction of the largest                 disease outbreaks and under the action of multiple con-
eigenvalue. These containment strategies requires that                    tainment strategies.
many individuals become users. For example, 50% of
mask users will reduce the reproductive number by just
20%. Another important observation is that, based on
the assumptions make here, mask use is more effective                                     ACKNOWLEDGEMENTS
that smartphone tracing app use. This is because mask
use reduces the probability of transmission between mask                    This work was supported by Cancer Research UK
users and non-users, while the smartphone tracing app                     C596/A21140.
 [1] S. Eubank, H. Guclu, V. S. Kumar, M. V. Marathe,                      [5] N. G. Davies and et al, The Lancet Public Health 5, e375
     A. Srinivasan, Z. Toroczkai, and N. Wang, Nature 429,                     (2020).
     180 (2004).                                                           [6] F. Liljeros, C. R. Edling, L. A. Amaral, H. E. Stanley,
 [2] J. Zhang and et al, Science 368, 1481 (2020).                             and Y. Aberg, Nature 411, 907 (2001).
 [3] A. Aleta, D. Martı́n-Corral, A. Pastore y Piontti,                    [7] A. Vazquez, Phys. Rev. E 74, 066114 (2006).
     M. Ajelli, M. Litvinova, M. Chinazzi, N. E. Dean, M. E.               [8] A. Vazquez, Phys. Rev. Lett. 96, 038702 (2006).
     Halloran, I. M. Longini Jr, S. Merler, A. Pentland,                   [9] A. Vazquez, medRxiv 2020.07.23.20160531.
     A. Vespignani, E. Moro, and Y. Moreno, Nature Hu-                    [10] A. J. Laub, Matrix Analysis For Scientists And Engineers
     man Behaviour 4, 964 (2020).                                              (Society for Industrial and Applied Mathematics, USA,
 [4] P. G. T. Walker and et al, Science 369, 413 (2020).                       2004).
