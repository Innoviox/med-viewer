medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
      ( ), 1–31                                                                                                                               :
                       BayesSMILES: Bayesian Segmentation Modeling
                                for Longitudinal Epidemiological Studies
                       Shuang Jiang1,2 , Quan Zhou3 , Xiaowei Zhan∗2 , and Qiwei Li†4
              1
                Department of Statistical Science, Southern Methodist University, Dallas, TX 75205, USA
            2
              Quantitative Biomedical Research Center, Department of Population and Data Sciences, The
                         University of Texas Southwestern Medical Center, Dallas, TX 75390, USA
                  3
                    Department of Statistics, Texas A&M University, College Station, TX 77843, USA
     4
       Department of Mathematical Sciences, The University of Texas at Dallas, Richardson, TX 75080, USA
                                                                 Abstract
     Coronavirus disease 2019 (COVID-19) is a pandemic. To characterize the disease transmissibility,
     we propose a Bayesian change point detection model using daily actively infectious cases. Our
     model is built upon a Bayesian Poisson segmented regression model that can 1) capture the
     epidemiological dynamics under the changing conditions caused by external or internal factors;
     2) provide uncertainty estimates of both the number and locations of change points; 3) adjust
     any explanatory time-varying covariates. Our model can be used to evaluate public health
     interventions, identify latent events associated with spreading rates, and yield better short-term
     forecasts.
     Keywords Bayesian hierarchical modeling; Multiple change-point detection; Poisson segmented
     regression; Stochastic SIR model.
     1       Introduction
     A newly identified coronavirus, SARS-CoV-2, is a lethal virus for humans. It has caused the
     worldwide pandemic – COVID-19. As reported by the Johns Hopkins University Center for
     Systems Science and Engineering (JHU-CSSE), the COVID-19 pandemic has spread to 188
     countries and territories with more than 14 million confirmed cases by the end of July 2020.
     The extremely rapid spreading of the disease and the increasing burden on healthcare systems
     becomes a major problem for public health. In a response to "flatten the curve" (Akiyama et al.,
     2020), both federal and local governments in the United States (U.S.) have enforced a wide range
     of public health measures, such as border shutdowns, travel restrictions, and quarantine.
            As a consequence, the importance of understanding the COVID-19 dynamics is steadily
     increasing in the contemporary world. In epidemiology, the basic reproduction number, denoted
     by R0 , is commonly used to evaluate the transmissibility of an infectious disease like COVID-19.
     R0 is interpreted as the expected number of secondary cases produced by a typical case in a closed
     population. During the outbreak of an epidemic, R0 can be affected by intervention strategies.
     For example, social measures that decrease the contact rate between individuals would control
     R0 . Isolating or treating the infected cases could lower the R0 value as well. Another concept
     in the epidemic theory is the effective reproduction number Rt , which describes the number
     of people who can be infected by an individual at any specific time t in a population. Rt is
     time-specific since it accounts for the varying proportions of the population that are immune to
         ∗
           Corresponding author. Email: Xiaowei.Zhan@UTSouthwestern.edu
         †
           Corresponding author. Email: Qiwei.Li@UTDallas.edu
     Received
       NOTE: This;preprint
                   Acceptedreports new research that has not been certified by peer review and should not be used to guide clinical practice.1

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
     2                            Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     the disease over time. There are many recent studies implementing the SIR model (Kermack
     and McKendrick, 1927) or its modified version to analyze the COVID-19 transmissibility in
     terms of R0 or Rt (see e.g. Chen et al., 2020; Alvarez et al., 2020; Kantner and Koprucki, 2020;
     Gostic et al., 2020; Cooper et al., 2020). Furthermore, several studies have incorporated the
     information on social measures to understand the COVID-19 dynamics over the world. For
     instance, Dehning et al. (2020) combined the SIR model with Bayesian inference to study the
     time-varying spreading rate of COVID-19 in Germany. Song et al. (2020) extended the SIR model
     by considering the quarantine protocols with a focus on understanding the time-course dynamics
     of COVID-19 in Hubei, China. Giordano et al. (2020) enriched the SIR model with additional
     compartments to account for under-diagnosis, which could explain the gap between the actual
     infection dynamics and perception of COVID-19 outbreak in Italy. Because of heterogeneity in
     susceptibility and social dynamics, the COVID-19 transmissibility differs among locations and
     change over time. U.S. local governments have started different interventions since mid-March
     to combat the widespread of COVID-19. Therefore, the basic reproduction numbers should
     spatiotemporally vary.
           The basic reproduction number of an epidemic event is changing due to the effects of societal
     and political actions. The effective social measures such as business closures and stay-at-home
     orders could help lower the transmission rate and thus induce changes in R0 . By studying the
     variations in R0 over time, we can evaluate the dynamic transmissibility of infectious diseases
     like COVID-19. For instance, during the outbreak of severe acute respiratory syndrome (SARS)
     in China around 2003, it was reported an R0 ≈ 3.0 for the onset stage of SARS in Hong
     Kong (Riley et al., 2003; Lloyd-Smith et al., 2003). Later on, the reported R0 for Hong Kong
     dropped to about 1.1 due to stringent control measures (Chowell et al., 2004). Decreasing in
     R0 captured the evolution of SARS transmission dynamics under the efficient diagnosis coupled
     with patient isolation measures. A recent study in Germany (Dehning et al., 2020) estimated the
     variations in COVID-19 transmission rates for the four phases defined by the time of three major
     government interventions. These studies motivated us to detect the important transitioning
     times that occurred during the COVID-19 outbreak in the U.S..
           We propose a method named BayesSMILES, which is short for Bayesian Segmentation
     ModelIng for Longitudinal Epidemiological Studies, to study the dynamics of COVID-19 trans-
     missibility and to evaluate the effectiveness of mitigation interventions. The BayesSMILES
     adopts a Bayesian Poisson segmented regression model to detect multiple change points based
     on the daily infectious COVID-19 cases. This novel model can 1) capture the epidemiological
     dynamics under the changing conditions caused by external or internal factors; 2) quantify the
     uncertainty in both the number and locations of change points; 3) adjust any relevant explanatory
     time-varying covariates that may affect the infectious case numbers. In addition, the BayesS-
     MILES integrates the change point information to quantify the COVID-19 transmissibility by
     estimating the basic reproduction numbers in different segments. On the simulated data, we
     demonstrate that our approach can improve the accuracy of the change point detection, com-
     pared with a widely used change point search method. Applying the proposed BayesSMILES to
     state-level COVID-19 daily report data, we find that the detected change points correlate well
     with the times of publicly announced interventions. We also demonstrate that a stochastic SIR
     model that incorporates change point information can provided a better short-term forecast. In
     all, the BayesSMILES enables us to understand the disease dynamics of COVID-19, and provides
     useful insights for the anticipation and control of current and future pandemics.
           The rest of the paper is organized as follows. We review the traditional susceptible-infectious-
     recovered (SIR) model in Section 2. In Section 3, we describe the framework of the proposed

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                           3
     BayesSMILES. The Markov chain Monte Carlo (MCMC) algorithm and posterior inference pro-
     cedures are described in Section 4. We provide a comprehensive simulations study to illustrate
     the performance of the proposed method against a competing approach in Section 5. In Section
     6, we analyze the COVID-19 data for U.S. states using the proposed BayesSMILES. Finally, we
     conclude with remarks in Section 7 and provide information about implementation in Section 8.
     2     Review of the SIR Model
     The susceptible-infected-removed (SIR) model was developed to simplify the mathematical mod-
     eling of human-to-human infectious diseases by Kermack and McKendrick (1927). It is a fun-
     damental compartmental model in epidemiology. At any given time, each individual in a closed
     population with size N is assigned to three distinctive compartments with labels: susceptible
     (S), infectious (I), or removed (R, being either recovery or dead). The standard SIR model in
     continuous time that models the flow of people from S to I and then from I to R is described
     by the following set of nonlinear ordinary differential equations (ODEs):
                                               dS(t)
                                               dt
                                                          = −βN −1 S(t)I(t)
                                                 dI(t)
                                                   dt      = βN −1 S(t)I(t) − γI(t)                                               (1)
                                               dR(t)
                                              
                                                   dt       = γI(t)
     for t > 0, subjecting to S(t) + I(t) + R(t) = N . Here β > 0 is the diseases transmission rate
     and γ > 0 is the removal (recovery or death) rate. Conceptually, susceptible individuals become
     infectious (S → I) and then are ultimately removed from the possibility of spreading the disease
     (I → R) due to death, recovery with immunity against reinfection, or isolation from the rest of
     the population (quarantine).
           The rationale behind the first equation is (1) is that the number of new infections during
     an infinitesimal amount of time, −dS(t)/dt, is equal to the number of susceptible people, S(t),
     times the product of the contact rate, I(t)/N , and the disease transmission rate β. The third
     equation in (1) reflects that the infectious individuals leave the infectious population per unit
     time, dI(t)/dt, as a rate of γI(t). The second equation in (1) follows immediately from the
     first and third ones as a result of dS(t)/dt + dI(t)/dt + dR(t)/dt = 0. Assuming that only a
     small fraction of the population is infected or removed in the onset phase of an epidemic, we
     have S(t)/N ≈ 1 and thus the second equation reduces to dI(t)/dt = (β − γ)I(t), revealing
     that the infectious population is growing if and only if β > γ. As the expected lifetime of an
     infected case is given by γ −1 , the ratio β/γ is the average number of new infectious cases directly
     produced by an infected case in a completely susceptible population. Since it is a good indicator
     of the transmissibility of an infectious disease, the epidemiologists name it the basic reproduction
     number R0 = β/γ in the context of a standard SIR model, or the effective reproduction number
     Rt = βt /γt in the context of a time-variant SIR model, where β and γ are replaced by β(t) and
     γ(t) in (1).
     3     The Proposed BayesSMILES Method
     3.1      Data notations
     During a pandemic such as COVID-19, the most accessible and complete data are the daily
     reported numbers on confirmed cases and deaths. Suppose N is the total population size in

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
     4                            Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     a given region. Let C = (C1 , . . . , CT ) and D = (D1 , . . . , DT ) be the sequences of cumulative
     confirmed case and death numbers observed at T successive equally spaced points in time (e.g.
     day), where Ct and Dt ∈ N for t = 1, . . . , T . For a region of which recovery cases are closely
     monitored day by day, we use E = (E1 , . . . , ET ) to denote the sequence of cumulative recovery
     case numbers. Thus, due to the compositional nature of the basic SIR model, the three tra-
     jectories can be constructed as S = (S1 , . . . , ST ) with St = N − Ct , R = (R1 , . . . , RT ) with
     Rt = Dt + Et , and I = (I1 , . . . , IT ) with It = N − St − Rt = Ct − Dt − Et . For a region of which
     recovery cases do not exist or under-reported, we consider both R and I as missing data and
     reconstruct these two sequences according to the last equation of (1) with a pre-specified constant
     removal rate γ. Specifically we set I1 = C1 and R1 = 0, and generate Rt = Rt−1 + drIt−1 e and
     It = It−1 + (Ct − Ct−1 ) − (Rt − Rt−1 ) from t = 2 to T sequentially, where d·e : [0, ∞) → N denotes
     the ceiling function. For the choice of γ, we suggest estimating its value from publicly available
     reports in some region where confirmed, death, and recovery cases are all well-documented, or
     from prior epidemic studies due to the same under-reporting issue in actual data. Lastly, let
     Y0 be the initial value and Ẏ = (Ẏ1 , . . . , ẎT ) be the lag one difference of a sequence Y , where
     Ẏ1 = Y1 − Y0 and each following entry Ẏt = Yt − Yt−1 , t = 2, . . . , T , i.e. the difference between
     two adjacent observations. Note that Y could be any of those time-series data introduced above,
     i.e. C, D, E, S, I, and R.
     3.2      Modeling epidemic dynamics via a modified stochastic SIR model
     An SIR model has three trajectories, one for each compartment. The compositional nature of
     the three trajectories, i.e. S(t) + I(t) + R(t) = N , implies that we only need two of them to
     solve the ODEs as shown in (1). As mentioned previously, assuming S(t) ≈ N for all t results
     in dI(t)/dt = (β − γ)I(t) and further leads to an exact solution: I(t) = I(0) exp((β − γ)t). For
     modeling daily reported infectious data I, we utilize its discrete-time version,
                                                       It    =     I0 exp ((βt − γ)t)                                             (2)
     with a time-varying rate βt to account for the transmissibility changes of the disease. For
     simplicity’s sake, we assume a constant removal rate γ. Based on (2), we introduce a probabilistic
     model, which approximately mimics the dynamics of the deterministic standard SIR model as
     shown in (1) during the onset phase of a pandemic. Specifically, we suppose the infectious
     population size at time t is sampled from a Poisson model,
                                                It |αt    ∼     Poi(N αt ),    t = 1, . . . , T,                                  (3)
     where αt = I0 exp ((βt − γ)t)/N is a redefined time-varying transmissibility parameter that de-
     pends on the initial infectious population size I0 , the transmission rate βt , the removal rate γ, and
     any latent factors (e.g. public health intervention, social behavior, virus mutation, healthcare
     quality, etc.) that may affect the disease transmissibility. This model automatically accounts
     for measurement errors and uncertainties associated with the counts. Note that (3) can be gen-
     eralized to a negative binomial (NB) model, i.e. It |αt ∼ NB(N αt , φI ) if needed, where φI is a
     dispersion parameter to account for over-dispersion that might be observed in I. Here we use
     NB(µ, φ), µ, φ > 0 to denote an NB distribution with expectation µ and variance µ + µ2 /φ.
     3.3      Detecting change points via a Poisson segmented regression model
     Our change point detection builds upon the above modified stochastic time-variant SIR model
     (3) with stationary transmissibility αt in a certain segment. Particularly, we assume that βt

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                           5
     only changes at certain time points. Identifying those change points is of significant importance,
     as it not only enables us to characterize the temporal dynamics of the pandemic but also helps
     policymakers evaluate the effectiveness of the past and ongoing mitigation and intervention
     strategies.
           In this paper, the change points are defined as those discrete time points that significantly al-
     ter the transmission rate βt between two adjacent segments, while assuming the removal rate γ is
     constant across all time points. We introduce a latent binary vector γ = (γ1 , . . . , γT ), γt ∈ {0, 1},
     with γt = 1 if time point t is a change point and γj = 0 otherwise. We restrict γ1 = 1,
     although the first time point is not a change point. Those points with γj = 0 can be par-
     titioned into segments bounded by two adjacent change points. Thus, we use another vector
     z = (z1 , . . . , zT ), zi ∈ {1, . . . , K} to reparameterize γ, where zt = k if time point t is in segment
     k, that is, between the k and (k + 1)-th change points. The total number of change points
            P the first time point is K − 1. Mathematically, z is the cumulative sum of γ, i.e.
     excluding
     zt = tu=1 γu , while γ is the lag one difference of z, i.e. γt = zt − zt−1 with γ1 = 1. Figure
     1 shows the representation of γ and z for a simulated time-series dataset (T = 10) with two
     change points.
     Figure 1: An example of time-series data (T = 10) with two change points (K = 3) and its associated param-
     eterizations in terms of γ and z, respectively. Red triangles are change points, while black circles are not. Note
     that the first time point is not a change point, although it is defined as a "change point" for convenience’s sake.
           To infer γ or z given the sequence of infectious population size I, we adopt a Poisson
     segmented regression framework, which can be written as,
                                                     It |αt    ∼     Poi(N αt ),     t = 1, . . . , T
                                                                                                                                  (4)
                                          log αt |zt = k       =     xTt bk + t ,
     where xt is a p-dimensional column vector of covariates that includes a scalar of one for the
     intercept, time t, and p − 2 explanatory variables observed at time t if applicable. Those ex-
     planatory variables could contain the number of tests, weather information, or other temporal
     information that are important to adjust for during a longitudinal epidemiological study. bk is
     a p-dimensional column vector of segment-specified coefficients that includes an intercept repre-
     senting the proportion of infectious people at logarithmic scale, i.e. bk1 = log(I0 /N ), in segment
     k, and a slope accounting for the segment-varying transmission rate, i.e. bk2 = βk − γ. For
     simplicity’s sake, we assume that t is an independent and identically distributed random vari-
     able from a zero-mean normal distribution with segment-specific variance t ∼ N(0, σk2 ). To

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                          It is made available under a CC-BY 4.0 International license .
     6                            Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     ensure the identifiability of all model parameters, we try a set of considerably small values for
     σk2 ’s and employ a robust cross validation method called Pareto-smoothed importance sampling
     leave-one-out (PSIS-LOO) cross validation to determine the best choice (Vehtari et al., 2017).
             PTαk be the sequence of all αt ’s in segment k, i.e. (αck , . . . , αck +nk −1 ), where we denote
            Let
     ck =             I(z = k)I(γt = 1) as the time point corresponding to the k-th change point and
             Pt=1 t
     nk = Tt=1 I(zt = k) as the number of time points in segment k. We can rewrite the second
     stage in (4) as log αk |bk ∼ MN(Xk bk , σk2 Ink ), where Ink is an identity matrix and Xk can be
     explicitly written as
                                                                                                      
                                           1 tck               xck ,1        · · · xck ,p−2
                                       1 tc +1
                                                   k
                                                               xck +1,1      · · · xck +1,p−2          
                                                                                                       .
                                                                                                      
                                       .. ..                 ..             . .    .
                                                                                    .
                                       . .                    .                 . .                   
                                           1 tck +nk −1 xck +nk −1,1 · · ·          xck +nk −1,p−2
     We assume a zero-mean multivariate normal distribution for bk , that is, bk ∼ MN(0p , H), where
     0p is an p-by-1 all zero column vector and H = Diag(h21 , . . . , h2p ) is set to be a diagonal variance-
     covariance matrix. For a non-informative setting, we recommend choosing a large value for each
     h2j . Through this prior specification, we are able to marginalize out the nuisance parameter bk
     and obtain log αk ∼ MN 0nk , Xk HXkT + σk2 Ink . Consequently, we can write the collapsed
                                                                           
     model of (4) as
                                                                 YT
                                    I1 , . . . , IT |α    ∼           Poi(N αt )
                                                                 t=1
                                                                                                                                  (5)
                                                                 YK
                                                                      MN 0nk , Xk HXkT + σk2 Ink .
                                                                                                         
                                            log α|γ       ∼
                                                                 k=1
     QT complete the model specification, we impose an independent Bernoulli prior on γ as γ|ω ∼
     To
        t=2 Bern(ω), where ω is interpreted as the probability of a time point being a change point a
     priori. We further relax this assumption by allowing ω ∼ Be(aω , bω ) to achieve a beta-Bernoulli
     prior. In practice, we suggest a constraint of aω + bω = 2 for a vague hyperprior of ω (Tadesse
     et al., 2005). In addition to that, we make the prior probability of γ equal to zero if two adjacent
     time points are jointly selected as change points. In other words, a segment should consist of at
     least two time points.
     3.4      Estimating basic reproduction numbers via a stochastic SIR model
     Given the multiple change points γ, we estimate the basic reproduction number R0 for each
     segment via a stochastic version of the standard SIR model as shown in (1), which only needs
     the cumulative confirmed case numbers C. This is because recovery data only exist in few states
     in the U.S., which makes both model inference and predictions infeasible. This model considers
     both of the removed and actively infectious cases as missing data and mimic their relationship
     in spirit to some compartmental models in epidemiology. Specifically, we assume the number of
     new removed cases at time t, i.e. Ṙt , is sampled from a Poisson distribution with mean γIt−1 ,
     that is, Ṙt ∼ Poi(γIt−1 ) = Poi(γ(N − Ct−1 − Rt−1 )), where γ should be pre-specified. Based on
     this simplification, we rewrite the discrete version of the first equation in (1) as,
                                                                                           N − Ct−1 − Rt−1
                            (N − Ct ) − (N − Ct−1 )               =     −β(N − Ct−1 )                         ,
                                                                                                      N

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                           7
     resulting in
                                                                          N − Ct−1 − Rt−1
                                              Ċt  =      β(N − Ct−1 )                             .
                                                                                     N
           We further assume the new case number observed at time t, i.e. Ċt , is sampled from an NB
     model,
                                                                  N − Ct−1 − Rt−1
                                                                                            
                          Ċt ∼ NB β(N − Ct−1 )                                          , φ , t = 2, . . . , T,                  (6)
                                                                           N
     as it automatically accounts for measurement errors and uncertainties associated with the counts.
     Following most epidemiological models, we assume this stochastic process is a Markov process,
     where the present state (at time t) depends only upon its previous state (at time t − 1). For the
     prior distribution of the dispersion parameter φ, we choose a gamma distribution, φ ∼ Ga(aφ , bφ ).
     We recommend small values, such as aφ = bφ = 0.001, for a non-informative setting. This
     model, on average, mimics the epidemic dynamics and is more flexible than those deterministic
     epidemiological models. We assume β comes from a gamma distribution with hyperparameters
     that makes both mean and variance of the transformed variable R0 = β/γ equal to 1.
     4     Model Fitting
     In this section, we describe the Markov chain Monte Carlo (MCMC) algorithms for posterior
     inference of the proposed BayesSMILES method, including the inferential strategy to identify
     change points and to estimate the basic reproduction numbers, respectively.
     4.1      MCMC algorithms for detecting change points
     Our primary interest lies in identifying the change point locations via the vector γ based on the
     actively infectious cases I. According to Section 3.3, the full data likelihood and the priors of
     the change point detection model are written as,
                                                   YT
                               f (I|α)        =        Poi(It ; αt )
                                                   t=1
                                                    K                                                       
                                                                  (γ)            (γ)        (γ) T
                                                   Y
                                                                                                        2
                               π(α|γ)         =         MN αk ; 0n(γ) , Xk HXk                    + σk In(γ)                      (7)
                                                                         k                                k
                                                   k=1
                                                   YT
                                   π(γ)       =        Be-Bern(γt ; aω , bω ),
                                                   t=2
     where we use the superscript (γ) to denote the transmissibility parameters αk , the design matrix
     Xk , and the number of time points nk in segment k under a specific configuration of γ. At each
     MCMC iteration, we perform the following steps.
           Update change point indicator γ: We update the binary latent vector γ via an add-
     delete-swap algorithm. We randomly select an entry in γ, say γt , and change its value to
     γt∗ = 1 − γt to form a new γ ∗ . This is an add step if γt∗ = 1 and a delete step otherwise. The
     swap step is performed every ten iterations, where we randomly select a change point, say γt = 1,
     and swap the values between the t and (t ± 1)-th entries in γ to form a new γ ∗ . We accept the

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
     8                            Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     proposed γ ∗ with the probability min(1, mMH ), where the Hasting ratio is
                          π(α|γ ∗ ) π(γ ∗ ) J(γ ∗ ← γ)
             mMH =
                           π(α|γ) π(γ) J(γ ← γ ∗ )
                                                                                                       
                          QK                   (γ ∗ )                (γ ∗ )    (γ ∗ ) T       2
                              k=1 MN αk ; 0n(γ ) , Xk
                                                              ∗             HXk          + σk In(γ ∗ )       aω /bω
                                                                                                                      for add
                                                            k                                    k
                      =                                                                                 × bω /aω     for delete
                                QK                    (γ)             (γ)     (γ) T         2I               
                                   k=1  MN        α   k   ; 0 nk , X k    HX  k        +  σ k nk
                                                                                                             
                                                                                                               1       for swap
     Here we use J(· ← ·) to denote the proposal probability distribution for the selected move.
     Note that the last proposal density ratio equals one. This step simultaneously updates the
     segmentation vector z, as it can be constructed from γ.
           Update transmissibility parameters α: For each segment partitioned by γ, we update
     αt within the same segment, say segment k, sequentially by using a random walk Metropolis-
     Hastings (RWMH) algorithm. We first propose a new αt∗ , of which                              logarithmic value is generated
                             2
                                          (γ) ∗                            ∗
     from N log αt , τα . Let αk = αc(γ) , . . . , αt , . . . , αc(γ) +n(γ) −1 . Then we accept the proposed
                                                              k                        k      k
     value αt∗ with probability min(1, mMH ), where the Hastings ratio is
                                         f (I|α∗ ) π(α∗ |γ) J(α∗ ← α)
                             mMH =
                                          f (I|α) π(α|γ) J(α ← α∗ )
                                                                                                                    
                                                                        (γ) ∗             (γ)      (γ) T      2
                                                             MN αk ; 0n(γ) , Xk HXk                       + σk In(γ)
                                         Poi(It ; αt∗ )                         k                                 k
                                     =                                                                             .
                                         Poi(It ; αt )                   (γ)             (γ)      (γ) T      2
                                                              MN αk ; 0n(γ) , Xk HXk                     + σk In(γ)
                                                                               k                                 k
     Note that the proposal density ratio cancels out for this RWMH update. The computation of
     the multivariate normal (MN) probability density involves matrix inversion, which can be time-
                                                     (γ)
     consuming, particularly when nk is large. To significantly improve the computational efficiency,
     we follow Zhou and Guan (2018) to approximate the exact inversion under an appropriate choice
     of H that satisfies the asymptotic condition. As mentioned previously, H is a p-by-p diagonal
     matrix, where the first entry h21 corresponds to the variance of the normal prior on bk1 . Under
                                                                                                         (γ)      (γ)
     the asymptotic condition of h21 ≥ h2j , ∀j 6= 1, the inversion of an nk -by-nk matrix reduces to
     an inversion of a p-by-p matrix (See more details in Appendix). In practice, we set h21 = 10, 000
     and h22 = . . . = h2p = 10 to ensure this asymptotic condition.
     4.2      MCMC algorithms for estimating basic reproduction numbers
     Once the change points are determined, we aim to estimate the basic reproduction numbers R0 ’s
     across different segments and quantify their uncertainties based on the cumulative confirmed
     cases C only. According to Section 3.4, the full data likelihood and the priors of the stochastic

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                                BayesSMILES                                                          9
     SIR model are written as,
                                                  K
                                                                                            N − Ct−1 − Rt−1
                                                 Y      Y                                                                 
                  f (C|β, φ, R)           =                      NB Ct ; βk (N − Ct−1 )                              , φk
                                                                                                        N
                                                 k=1 {t:zt =k}
                                                 YK
                               π(β)       =          Ga(βk ; aβ , bβ )                                                            (8)
                                                 k=1
                                                 YK
                               π(φ)       =          Ga(φk ; aφ , bφ ),
                                                 k=1
     where β = (β1 , . . . , βK ) and φ = (φ1 , . . . , φK ), i.e. the collections of transmission and dispersion
     rates of all segments. For the hyperparameters, we set aβ = 1 and bβ = 1/γ so that both of
     the expectation and variance of the basic reproduction number R0 = βk /γ are equal to one. We
     specify aφ = bφ = 0.001 to obtain a weakly informative gamma prior for all dispersion parameters.
     With a pre-defined removal rate γ, we propose the following updates in each MCMC iterations.
           Generate R based on C: We assume I1 = C1 and R1 = 0, i.e. all the confirmed cases
     are capable to pass the disease to all susceptible individuals in a closed population at time
     point t = 1. Then we sample R2 ∼ Poi(γI1 ), where γ is a pre-specified tuning parameter.
     Due to the compositional nature of the SIR model, we can compute I2 = I1 + Ċ2 − Ṙ2 , where
     Ċ2 = C2 −C1 and Ṙ2 = R2 −R1 are the new confirmed cases and new removed cases at time point
     t = 2, respectively. Next, we repeat this process of sampling Rt ∼ Poi(γIt−1 ) and computing
     It = It−1 + Ċt − Ṙt , t = 3, . . . , T , to generate the sequence R used in an iteration.
           Update dispersion parameters φ: For each segment, we update φk by using                                       a RWMH   
                                                       ∗
     algorithm. We first propose a new φk , of which logarithmic value is generated from N log φk , τφ2 .
     Let φ∗ = (φ1 , . . . , φ∗k , . . . , φK ), where only the k-th entry is replaced. Then we accept the
     proposed value φ∗k with probability min(1, mMH ), where the Hastings ratio is
                                  f (C|β, φ∗ , R) π (φ∗ ) J (φ ← φ∗ )
                     mMH =
                                   f (C|β, φ, R) π (φ) J (φ∗ ← φ)
                                                                                                   
                                  Q                                           N −Ct−1 −Rt−1       ∗
                                                NB    C t ; β  (N  − C t−1 )                  , φ k Ga(φ∗  k ; aφ , bφ )
                                     {t:zt =k}               k                      N
                              =Q                                                                                       .
                                                                              N −Ct−1 −Rt−1           Ga(φ k ; aφ , bφ )
                                     {t:zt =k} NB Ct ; βk (N − Ct−1 )               N         , φk
     Note that the proposal density ratio cancels out for this RWMH update.
           Update transmission rates β: For each segment, we update βk by using                                          a RWMH   
                                                       ∗
     algorithm. We first propose a new βk , of which logarithmic value is generated from N log βk , τβ2 .
     Let β ∗ = (β1 , . . . , βk∗ , . . . , βK ), where only the k-th entry is replaced. Then we accept the
     proposed value βk∗ with probability min(1, mMH ), where the Hastings ratio is
                                  f (C|β ∗ , φ, R) π (β ∗ ) J (β ← β ∗ )
                      mMH =
                                   f (C|β, φ, R) π (β) J (β ∗ ← β)
                                                                                                   
                                  Q                           ∗               N −Ct−1 −Rt−1
                                     {t:zt =k} NB Ct ; βk (N − Ct−1 )               N         , φ k   Be(βk∗ ; aβ , bβ )
                              =Q                                                                                       .
                                                NB    C   ; β   (N −  C     ) N −Ct−1 −Rt−1
                                                                                              , φ     Be(βk ; aβ , bβ )
                                     {t:zt =k}           t k            t−1         N             k
     Note that the proposal density ratio cancels out for this RWMH update.

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                          It is made available under a CC-BY 4.0 International license .
     10                           Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     4.3      Posterior inference
     We explore posterior inference on the parameters of interest by postprocessing the MCMC sam-
     ples after burn-in. We start by obtaining a point estimate of the change point indicator γ
     by analyzing its MCMC samples {γ (b) , . . . , γ (B) }, where b indexes the MCMC iteration after
     burn-in. One way is to choose the γ corresponding to the maximum-a-posteriori (MAP),
                                                  γ̂ MAP = argmax π(α(b) |γ (b) )π(γ (b) ).
                                                                 b
     The corresponding ẑ MAP can be obtained by taking the cumulative sum of γ̂ MAP . An alternative
     estimate relies on the computation of posterior pairwise probability matrix (PPM), that is, the
                                                                                                                              (b)
     probabilities that time point t and t0 are assigned into the same segment, ptt0 ≈ B
                                                                                                                 P
                                                                                                                     b=1 I(zt =
       (b)
     zt0 |·). This estimate utilizes the information from all MCMC samples and is thus more robust.
     After obtaining this T -by-T co-clustering matrix denoted by P , a point estimate of z can be
     approximated by minimizing the sum of squared deviations of its association matrix from the
     PPM, that is,
                                                                     X
                                               ẑ PPM = argmin            [I(zt = zt0 ) − ptt0 ]2 .
                                                              z
                                                                     t<t0
     The corresponding γ̂ PPM can be obtained by taking the difference between consecutive entries
     in ẑ PPM and set the first entry to one. To construct a “credible interval" for a change point, we
     utilize its local dependency structure from all MCMC samples of γ that belong to its neighbors.
     Due to the nature of the MCMC algorithm described in Section 4.1 , if a time point t is selected
     as a change point, i.e. γt = 1, then its nearby time points must not be a change point. Thus the
                                                                            (1)        (B)             (1)    (B)
     correlation between the MCMC sample vectors (γt , . . . , γt ) and (γt±u , . . . , γt±u ) tends to be
     negative when u is small. Thus, we define the credible interval of a change point as the two ends
     of all its nearby consecutive time points, of which MCMC samples of γ are significantly negatively
     correlated with that of the change point. This could be done via a one-sided Pearson correlation
     test with a pre-specified significant level, e.g. 0.05. Although quantifying uncertainties of change
     points is not formal, it performs very well in the simulation study and yields reasonable results
     in the real data analysis.
           We constructed the confidence interval for a selected change point t by evaluating its MCMC
                                     (1)           (B)
     samples γtMCMC = (γt , . . . , γt ). In particular, according to the swap step that updates γ in
     the MCMC algorithm, the change point was typically switching between the selected time point
     t and its close neighborhood in the MCMC iterations. This is due to the fact that the change
     in patterns between segments may not be abrupt, and therefore the time points closed to time t
     could also be accepted as a change point in an iteration. Hence, for each change point with γt = 1,
     we calculated the correlation between γtMCMC and γt+∆t                     MCMC . Here, we set different values for ∆t
     (e.g., ∆t = −3, −2, . . . , 1, 2) such that the collection of t+∆t included a reasonable neighborhood
     for time t. Then, we calculated the correlation between γtMCMC and γt+∆t                        MCMC . Given the fact that
     only one change point would appear in the neighborhood region, vector γtMCMC tended to have
     a negative correlation with γt+∆t           MCMC .
           Once the change points are determined, an approximate Bayesian estimator of the trans-
     mission rate βk for each segment k can be simply obtained by averaging over all of its MCMC
                                      (b)
     samples, β̂k = U
                           P
                               b=1 βk /B. In addition, a quantile estimation or credible interval can be ob-
     tained. Lastly, we summarize the basic reproduction number in each segment k as R̂0k = β̂k /γ.

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         11
     4.4      Prediction
     Conditional on the change point locations, we can predict the cumulative or new confirmed cases
     at any future time Tf by Monte Carlo simulation based on the information in the last segment
     K only. Specifically, from time T + 1 to Tf , we sequentially generate
                                                               N − Ct−1 − Rt−1 (b)
                                                                                           
                     (b)
                  Ċt        ∼ NB βK (N − Ct−1 )                                      , φK , t = T + 1, . . . , Tf .              (9)
                                                                        N
     Then, both short and long-term forecasts can be made by summarizing the (Tf −T )-by-B matrix
     of MCMC samples. For instance, the predictive number of cumulative and new confirmed cases
                                                           (b)                      (b)
     at time T + 1, in average, are B
                                                 P                        PB
                                                    b=1 CT +1 /B and        b=1 ĊT +1 /B, respectively.
     5     Simulation
     We used simulated data to evaluate the performance of our BayesSMILES method in terms of
     both change point detection and basic reproduction number estimation. It is shown that the
     proposed Bayesian framework outperforms alternative change point detection method.
     5.1      The generative model
     The three trajectories S, I, and R with length T = 120 were generated in the following ways.
     We first divided the T = 120 time points into K = 4 segments with the same length, that is,
     the true change points were t = 31, t = 61, and t = 91. In other words, the first 30 entries of
     z equal to 1, the following 30 entries equal to 2, the next 30 entries equal to 3, and the last
     30 entries equal to 4. To mimic the disease transmissibility dynamics across different segments,
     we chose segment-varying transmission rates βk while fixing the removal rate γ = 0.03. We
     considered four scenarios of the set (β1 , β2 , β3 , β4 ), corresponding to 1) R0 = (3.0, 1.2, 2.0, 0.8);
     2) R0 = (3.0, 2.3, 1.5, 0.8); 3) R0 = (3.0, 1.8, 0.8, 1.6); 4) R0 = (3.0, 2.0, 1.1, 0.5). Then
     based on the stochastic version of the standard SIR model, we sampled St and Rt from negative
     binomial (NB) distributions, and obtained It , sequentially from t = 1 to T through
                                      
                                                                              −1
                                       St = St−1 − NB(βzt−1 N St−1 It−1 , φS )
                                      
                                          Rt = Rt−1 + NB(γIt−1 , φR )                                   ,
                                      
                                          It = N − St − Rt
                                      
     where N = 1, 000, 000, the initial I0 = 100 and R0 = 0, and the dispersion parameters φS =
     φR = 10. Note that the generative scheme was with an NB error structure, which was different
     from our model assumption based on a Poisson error structure. We repeated the above steps to
     generate 50 independent datasets for each setting of R0 . Figure 2 displays the temporal patterns
     of the simulated infectious counts I for the four scenarios.
     5.2      Evaluation criteria
     To evaluate the change point detection, we may rely on either the binary change point indicator
     vector γ or the time point allocation vector z. For the choice of γ, a change point is considered
     to be correctly identified if its location is within a local window of the true position (Killick
     and Eckley, 2014). The selection of the window size is ad hoc and may bias the evaluation. In

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
                                                                                                                                                                                                                                      R0 = (3.0, 1.2, 2.0, 0.8)
                                                                                                                                                                                                                          Scenario 1: R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R0 = (3.0, 2.3, 1.5, 0.8)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Scenario 2: R0 <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2500
                                                                                                                                                                                                           2500
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2000
                                                                                                                                                                                                           2000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1500
                                                                                                                                                Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
                                                                                                                                                                                                      It   1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              It
                                                                                                                                                                                                           1000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1000
                                                                                                                                                                                                           500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    500
                                                                                                                                                                                                             0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                                                                                                                                                                                                  1     15     30     45                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     60        75   90   105   120               1   15   30    45                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               60        75   90   105   120
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Time index                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Time index
                                                                                                                                                                                                                                      R0 = (3.0, 1.8, 0.8, 1.6)
                                                                                                                                                                                                                          Scenario 3: R0<latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R0 = (3.0, 2.0, 1.1, 0.5)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Scenario 4: R0 <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                           2500
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  4000
                                                                                                                                                                                                           2000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  3000
                                                                                                                                                                                                      It   1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              It
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2000
                                                                                                                                                                                                           1000
                                                                                                                                                                                                           500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1000
                                         It is made available under a CC-BY 4.0 International license .
                                                                                                                                                                                                             0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0
                                                                                                                                                                                                                  1     15     30     45                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     60        75   90   105   120               1   15   30    45                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               60        75   90   105   120
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Time index                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Time index
                                                                                                                                                                                                      Figure 2: Simulation study: The simulated actively infectious data I under the four scenarios. Each curve represents a replicated sequence of I under a
                                                                                                                                                                                                      scenario. The red dashed lines mark the true change point locations. The blue curve under Scenario 4 was randomly chosen for evaluating the model fitting,
                                                                                                                                                                                                      of which results are shown in Figure 3.
                                                                                                                                                12

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         13
     addition to that, since change points and non-change points are usually of very different sizes,
     most of the binary classification metrics are not suitable for model comparison here. Thus,
     we chose those metrics that quantify the agreement between the true and estimated allocation
     vectors, i.e. z and ẑ. The two classic performance metrics for the analysis of clustering results are
     the adjusted Rand index (ARI) and mutual information (MI), proposed by Hubert and Arabie
     (1985) and Steuer et al. (2002), respectively. ARI is the corrected-for-chance version of the
     RandPindex (Rand, 1971), as a similarity            P measure between two sample               P allocation vectors. Let
     a = t>t0P      I(zt = zt0 )I(ẑt = ẑt0 ); b = t>t0 I(zt = zt0 )I(ẑt 6= ẑt0 ); c = t>t0 I(zt 6= zt0 )I(ẑt = ẑt0 );
     and d = t>t0 I(zt 6= zt0 )I(ẑt 6= ẑt0 ) be the number of pairs of time points that are a) in the
     same segment in both of the true and estimated partitions; b) in different segments in the true
     partition but in the same segment of the estimated one; c) in the same segment of the true
     partition but in different segments in the estimated one; and d) in different segments in both of
     the true and estimated partitions. Then, the ARI can be computed as
                                                      T
                                                        
                                                      2 (a + d) − [(a + b)(a + c) + (c + d)(b + d)]
                            ARI(z, ẑ) =                                                                      .
                                                           T 2
                                                             
                                                           2    − [(a + b)(a + c) + (c + d)(b + d)]
     The ARI usually yields values between 0 and 1, although it can yield negative values (Santos
     and Embrechts, 2009). The large the index, the more similar between z and ẑ, thus the more
     accurately the method detects the actual times at which change points occurred. An alternative
     metric choice is MI, which measures thePinformation about one variable that is shared by the
     other (Steuer et al., 2002). Let mkk0 = Tt=1 I(zt = k)I(ẑt = k 0 ) be the number of time points
     shared between the k-th segment in the true z and the k 0 -the segment in the estimated one ẑ.
     Then, the MI can be computed as
                                                                    K X K̂
                                                                  X          mkk0        mkk0 T
                                              MI(z, ẑ)      =                      log           ,
                                                                        0
                                                                               T         nk n̂k0
                                                                  k=1 k =1
     where K̂ is the number of segments and n̂k ’s are the segment lengths for segment 1, . . . , K̂ in ẑ.
     It yields non-negative values. The larger the MI, the more accurate the partition result.
           To quantify how well a method estimates the dynamic transmissibility across different seg-
     ments, we used the root mean square error (RMSE) that measures the deviation between the
     true and estimated values of R0 over all T time points:
                                                                          XT
                                           RMSE(R0 , R̂0 )          =         (R0zt − R̂0ẑt )/T.
                                                                          t=1
     A smaller value of RMSE indicates a more accurate estimation of R0 ’s.
     5.3      Results
     As for the MCMC setting of change point detection, we set 40, 000 MCMC iterations and dis-
     carded the first half as burn-in. We adopted the weakly informative setting by setting aω = 0.1
     and bω = 1.9 in the Beta-Bernoulli prior for the change point indicator vector γ. We set
     H = Diag(h21 , h22 ) with h21 = 10, 000 and h22 = 10 as the covariance matrix in the prior distri-
     bution of bk ’s. Finally, we let σk2 take ten equally spaced values ranging from 0.0001 to 0.01
     at the logarithmic scale (base 10) in the PSIS-LOO cross validation. In fitting the stochastic

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
     14                           Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     SIR model, we set 100, 000 MCMC iterations with the first half as burn-in. PAs suggested in
                                                                                                         1      T    Rt −Rt−1
     Waqas et al. (2020), the value of removal rate γ could be estimated by T −1                                t=2      It       for
     each simulated dataset. Then, we set aβ = 1 and bβ = 1/γ so that both of the expectation and
     variance of the basic reproduction number R0 = βk /γ are equal to 1.
           We first checked the performance of the BayesSMILES on a single simulated dataset, which
     was randomly selected from the 50 replicates in Scenario 4 (marked as the blue line in Figure
     2). Figure 3(a) demonstrates the change point detection result based on the Poisson segmented
     regression model. The red dashed and the blue solid lines represent the true and the estimated
     change point locations, respectively, while the gray ribbons represent the 95% confidence intervals
     for those identified change points. As we can see, the BayesSMILES successfully detected the
     three true change points in general, as each of the 95% confidence intervals covered the truth.
     The resulted values of ARI and MI were 0.93 and 1.28, respectively. Later on, the stochastic SIR
     model introduced in Section 3.4 was then fitted to quantify the disease transmissibility in each
     segment bounded by the identified change points. Figure 3(b) shows the posterior distributions
     of R0k̂ ’s for k̂ = 1, 2, 3, 4 from their MCMC samples. The red dashed and blue solid line pinpoints
     the true and posterior mean of R0k̂ ’s, while the two black solid lines mark the boundary of their
     95% credible intervals. Clearly, those true values were within their corresponding 95% credible
     intervals. The final RMSE for R0 estimation was 0.38 for this single simulated dataset.
           To our best knowledge, there is no method like the BayesSMILES that can detect latent
     change points while characterizing the transmission dynamics through an SIR model. Thus, in
     setting up a comparison study, we therefore considered a two-stage approach that first identifies
     multiple change points of time-series data based on a likelihood based framework, and then
     estimates the basic reproduction numbers between each pair of nearby change points, following
     the stochastic SIR model introduced in Section 3.4. The alternative change point model assumes
     time points within one segment follow a normal distribution with distinct mean and/or variance
     from its nearby segments (Hinkley, 1970; Jen and Gupta, 1987), and it uses likelihood ratio test
     (LRT) to detect multiple change points. An algorithm named binary segmentation (Edwards and
     Cavalli-Sforza, 1965; Sen and Srivastava, 1975) is commonly used to compute the test statistics
     for the LRT with high efficiency (Killick et al., 2012). In our case, to detect change points using
     this alternative approach named likelihood ratio test with binary segmentation (LRT-BinSeg),
     we input the logarithmic scale of I into the function cpt.meanvar in the related R package
     changepoint (Killick and Eckley, 2014) for each of the simulated datasets. We specified to use
     the binary segmentation algorithm with up to 5 of change points to search for. Note that this
     restriction was not applicable to the alternative algorithms provided in the changepoint package.
     In practice, we found that the alternative algorithms tended to over-select the number change
     points.
           Figure 4(a) and (b) exhibit the change point detection performances for the four scenarios
     of R0 . Our BayesSMILES performed much better than the LRT-BinSeg with respect to change
     point detection under both performance metrics, ARI and MI. For instance, the ARI by the
     BayesSMILES increased 39.29% to 122.16% over the LRT-BinSeg among the four scenarios,
     while the growth in MI could be up to 60.54%. Figure 4(c) compares the ability to capture
     the transmission dynamics in terms of RMSE, which depends on the change point detection
     accuracy. As expected, Our BayesSMILES yielded smaller RMSE values across all scenarios
     since its identified change point locations were more accurate. In all, the simulation study
     demonstrated that the strengths of BayesSMILES.

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             BayesSMILES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        15
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Single simulated dataset from scenario 4:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        R
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        R00 = (3.0, 2.0, 1.1, 0.5)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                      3500
                                      3000
                                      2500
                                      2000
                            It
                                      1500
                                      1000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                True
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          change point
                                      500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Estimated
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          change point
                                                 0
                                                             1    6    12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                21     30         39                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      48                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              57           66           75     84           93                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           102        111             120
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Time index
                                                                               (a) Change point detection performance
                                                                          Segment 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Segment 2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Segment 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Segment 4
                                                                             95%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                95%
                                                                       Credible interval                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Credible interval
                                      1.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2.0
                                      1.0            5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1.5
                            Density                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Density
                                      0.8            4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           True R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              R0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   True R0<latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                       Density                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Density
                                      0.6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             R0 by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Estimated R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             R0 by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Estimated R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                     3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     posterior mean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         posterior mean
                                      0.4
                                                     2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0.5        2
                                      0.2
                                      0.0
                                                     1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1
                                                     0
                                                       2.0       2.5     3.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             3.5     4.0       4.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     5.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1.50           2.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2.5            3.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               3.5
                                                                 0.6           0.8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0.6             0.8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1.2
                                                                                R
                                                                                R00
                                                                                <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   R
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   R00
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  R0
                                                                          Segment 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Segment 4
                                                                             95%Segment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            95%Segment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 4
                                                                       Credible interval                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Credible interval
                                      2.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       5
                                      2.0            5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          4        5
                            Density                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Density
                                      1.5            4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           True R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                3        4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              R0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   True R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                       Density                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Density
                                      1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             R0 by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Estimated R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             R0 by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Estimated R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                     3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     posterior mean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         posterior mean
                                      0.5            2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1        2
                                      0.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0
                                                      0 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1
                                                     1.0                1.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0 0.6            0.8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1.0              1.2
                                                                 0.6            RR00
                                                                               0.8
                                                                                <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0.6             RR00
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   <latexit sha1_base64="KWs6nq/0orB/RDUsj8rpqUqHrVw=">AAACA3icbVC7TsMwFHV4lvIKsMFiUSExVQkPwVjBwlgQfUhNFDmO21p17Mh2kKooEgu/wsIAQqz8BBt/g9NmgJYrWT46517dc0+YMKq043xbC4tLyyurlbXq+sbm1ra9s9tWIpWYtLBgQnZDpAijnLQ01Yx0E0lQHDLSCUfXhd55IFJRwe/1OCF+jAac9ilG2lCBve+FgkVqHJsv82Kkhxix7C7PAyewa07dmRScB24JaqCsZmB/eZHAaUy4xgwp1XOdRPsZkppiRvKqlyqSIDxCA9IzkKOYKD+b3JDDI8NEsC+keVzDCft7IkOxKmyazsKlmtUK8j+tl+r+pZ9RnqSacDxd1E8Z1AIWgcCISoI1GxuAsKTGK8RDJBHWJraqCcGdPXketE/q7mn9/Pas1rgq46iAA3AIjoELLkAD3IAmaAEMHsEzeAVv1pP1Yr1bH9PWBauc2QN/yvr8AeGCmFA=</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1.2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   R0
                                                             (b) Basic reproduction number estimation performance
      Figure 3: Simulation study: The model fitting results based on a randomly selected simulated dataset (see the
      blue curve under Scenario 4 in Figure 2). (a) The locations of change points (blue solid lines) estimated from
      the posterior pairwise probability matrix (PPM) and their credible intervals (gray ribbons). The red dashed lines
      mark the true change point locations; (b) The posterior distributions of R0k ’s for k = 1, 2, 3, 4 estimated from the
      segmented time-series data, given the three identified change points as shown in (a). The red dashed and blue
      solid lines are the true and estimated values of R0k ’s, respectively. The two black solid lines are the lower and
      upper bounds of the 95% credible intervals.
      6      Analysis of COVID-19 Data
      In this section, we applied the BayesSMILES to the COVID-19 daily report data provided by
      JHU-CSSE (COVID-19 Data Repository). Several recent COVID-19 studies also based their
      analyses on this resource (Dong et al., 2020; Zhou and Ji, 2020; Toda, 2020). We first performed
      a preprocessing step to ensure the quality of the infectious data I for the model fitting. Due to
      the fact that the recovery cases did not exist for some U.S. states, we treated I and R as missing
      data and reconstructed the two sequences according to the process described in Section 3.1. The
      observed cumulative confirmed case numbers C were collected for each U.S. state starting from

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
      16                                                    Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
                                           Scenario 1       Scenario 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Scenario 3       Scenario 4                                      Scenario 1        Scenario 2        Scenario 3   Scenario 4
                                  1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1.5
            Adjusted Rand Index                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Mutual Information
                                  0.8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1.0
                                  0.6
                                  0.4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.5
                                  0.2
                                  0.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.0
                                                                         variable
                                        Method:     BayesSMILES     LRT−BinSeg                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Method:       BayesSMILES      LRT−BinSeg
                                               (a) Adjusted Rand index (ARI)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (b) Mutual information (MI)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Scenario 1       Scenario 2                              Scenario 3        Scenario 4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0.8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0.6
                                                                           R
                                                                           R00 RMSE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.4
                                                                               <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0.2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Method:      BayesSMILES      LRT−BinSeg
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (c) Root mean square error (RMSE)
      Figure 4: Simulation study: The violin plots of (a) adjusted Rand index, (b) mutual information, and (c) R0
      root mean square error from 50 replicated datasets generated under the four scenarios. Red and blue violins
      correspond to the results obtained by the BayesSMILES and LRT-BinSeg.
      an early stage of the pandemic outbreak. In particular, we chose the starting time for each state
      as when there were least ten confirmed COVID-19 cases for that state. We also set the removal
      rate γ = 0.1 as suggested by Pedersen and Meneghini (2020) and Weitz et al. (2020). Due to the
      fact that different states could have different starting times, we further trimmed the sequences I
      and R for each state based on the latest starting time available. Finally, we set March 22, 2020,
      as the new starting time (t = 1) for all 50 states, and let July 19, 2020, be the last observed
      time point (t = 120). We used the same hyperparameter and algorithm settings as described in
      Section 5.3.
      6.1                         Detecting change points for U.S. states
      We limit our analysis to four U.S. states with the highest cumulative confirmed cases as of July
      19, 2020, to keep the paper in a reasonable length. They are New York, Texas, California, and
      Florida. The results for the 46 remaining states are available in https://shuangj00.github.io/
      BayesSMILES/ (see details in Section 8). Figure 5 displays the detected change points, as well as
      the estimated basic reproduction number R0 ’s cross segments, for the four states. The associated
      confidence interval to each identified change point is represented by a gray ribbon. In general,
      those change points detected by the BayesSMILES indeed captured the important COVID-19
      events that might affect the transmission rates. For instance, some change points reflected
      the positive effects of the preventative strategies such as lockdown, while others explained the
      "bounce back" in confirmed cases after the reopening. Table 2 lists the change point locations

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         17
     and their potentially related events for the four states.
           In New York, the first change point was estimated to be March 28. We estimated the
     posterior mean of the basic reproduction number decreased from 2.24 (between March and to
     March 27) to 1.63 (between March 28 and April 8). Notably, March 28 was the date when the
     Centers for Disease Control and Prevention (CDC) issued a 14-day domestic travel advisory for
     non-essential persons, which presumably alleviated the situation for the populated states such as
     New York. The second change point appeared around April 9, and the R0 of the third segment
     dropped to 0.98 with a 95% credible interval of [0.76, 1.25]. This matched the exact day when
     the New York state posted its first drop of the ICU admissions since the COVID-19 outbreak
     began. The third change point was around April 27. Though there was no direct intervention
     issued in late April, we noticed that the mayor of New York City announced that all the major
     events had been canceled starting from April 20. This action could bring a positive effect in
     controlling the outbreak, and our estimation from the SIR model suggested a further decrease
     in the basic reproduction number down to 0.66 with a 95% credible interval of [0.54, 0.81]. We
     observed another change point around June 18, which was close to the Phase II reopening of
     New York state on June 22. During the Phase II reopening, restaurants were allowed for outdoor
     dining, stores opened for in-person retail, and more services resumed operational under strict
     limitations. Thus, we saw a little "bounced back" in R0 from 0.66 to 0.82. The last change
     point was on June 29. As expected, the basic reproduction number increased to 1.04 with a 95%
     credible interval of [0.84, 1.29] in the last segment. Although there was no public announcement
     around June 29 with a confidence interval from June 28 to July 4, we suspect that the increased
     social interaction during the Independence Day long weekend (between July 3 and July 5) could
     be responsible for the increase of the transmission dynamics.
           In Texas, there were five change points detected. The first change point was estimated to be
     March 28, the same day as the first one for New York state. Due to the similar reason, the policy of
     mandatory 14-day quarantines for travelers entering Texas could bring a decrease in terms of the
     basic reproduction number (decreased from 2.97 to 2.07). The second change point was around
     April 9 with a further drop of R0 to 1.14 with a 95% credible interval [0.96, 1.35]. We found that
     the Texas Governor had extended the state’s disaster declaration for an additional 30 days on
     April 12. The extension aimed at protecting the health and safety of Texans by ensuring adequate
     capabilities to support communities. Organizations such as the State Operations Center and the
     Strategic National Stockpile would continuously supply the state government with resources
     needed to protect residents. May 25 was detected as the third change point, and it was the first
     time that R0 increased after the two drops. The estimated basic reproduction number was 1.29
     with a 95% credible interval [1.02, 1.62]. This increase appeared around May 25 could be due to
     the Governor’s updated executive order issued on May 26 that allowed additional services and
     activities to open for phase II reopening. The next change point was around June 16, and R0
     further increased to 1.72 with a 95% credible interval [1.40, 2.11]. According to the prediction
     reported by UT Austin’s COVID-19 Modeling Consortium at the end of May, there might be a
     significant increase in the number of cases and hospitalizations beginning mid-June (News from
     kxan). Here, the change point location, as well as the increased basic reproduction number, were
     consistent with the results of this report. The last change point was around June 28 with an
     estimated decrease in R0 to 1.42 with a 95% credible interval [1.17, 1.72]. Notably, the Texas
     Governor issued multiple executive orders around late June to early July to mitigate the disease
     spreading. For instance, the executive order on June 26 reemphasized the limited occupancy for
     all business establishments in Texas. According to an executive order on July 2, all Texans were
     required to wear a face-covering in public spaces in counties with 20 or more positive COVID-19

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                 18                                                                                                                                                  Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
                                                                                                                                                                                     log(actively infectious cases / population)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 log(actively infectious cases / population)
                                                                                                                                                                                -5           -4                 -3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -2     -1         0     1          2                          -1.5                  -1.0                -0.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0.0       0.5   1.0       1.5   2.0
                                                                                                                                                                        03-22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           03-22
                                                                                                                                                                        03-27        1.82                3.88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           03-27
                                                                                                                                                                        04-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-01     1.40 1.34      3.11 1.98
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2.24 1.63
                                                                                                                                                                        04-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-06
                                                                                                                                                                                     0.99                1.64
                                                                                                                                                                                             2.70 1.28
                                                                                                                                                                        04-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-11
                                                                                                                                                                        04-16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-16     0.76   0.98    1.25
                                                                                                                                                                        04-21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-21
                                                                                                                                                                        04-26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-26
    Figure 5: Case study: The change point detection and basic reproduction number estimation for the states of New York, Texas, Florida, and California.
                                                                                                                                                                                     0.73    0.92        1.15
                                                                                                                                                                        05-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-01
                                                                                                                                                                        05-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-06
                                                                                                                                                                        05-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-11
                                                                                                                                                                        05-16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-16
                                                                                                                                                                        05-21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-21     0.54   0.66    0.81
                                                                                                                                                                        05-26        0.96                1.47                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-26
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Florida
                                                                                                                                                                                             1.19                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          New York
                                                                                                                                                                        05-31                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-31
                                                                                                                                                                        06-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-05
                                                                                                                                                                        06-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-10
                                                                                                                                                                        06-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-15
                                                                                                                                                                                     1.49    1.80        2.19
                                                                                                                                                                        06-20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-20
                                                                                                                                                                        06-25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-25     0.59   0.82    1.12
                                                                                                                                                                        06-30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-30
                                                                                                                                                                        07-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           07-05
                                                                                                                                                                                     1.22    1.45        1.72                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.84           1.29
                                                                                                                                                                        07-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           07-10            1.04
                                                                                                                                                                        07-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           07-15
                                                                                                                                                                                     1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1.5               2.0              2.5                                                            1.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1.5               2.0
    The black circles are the actively infectious case numbers divided by the total population (in thousands) at logarithmic scale, i.e. log(It /N ). The black solid
                                                                                                                                                                                                                   <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>                                                                                                                  <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                     0 estimation
                                                                                                                                                                                                                   RR0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     R00 estimation
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           R
                                                                                                                                                                                     log(actively infectious cases / population)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 log(actively infectious cases / population)
                                                                                                                                                                                 -5                      -4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 -3          -2          -1    0          1                          -6                                       -4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -2              0
                                                                                                                                                                        03-22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           03-22
                                                                                                                                                                        03-27                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           03-27
                                                                                                                                                                                      1.72      2.20        2.79
                                                                                                                                                                        04-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-01        1.90 1.69   2.96 2.07   3.95 2.52
                                                                                                                                                                        04-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-06
                                                                                                                                                                        04-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-11
                                                                                                                                                                        04-16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-16
                                                                                                                                                                        04-21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-21
                                                                                                                                                                        04-26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           04-26
                                                                                                                                                                        05-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-01        0.96        1.14        1.35
                                                                                                                                                                        05-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-06
    lines pinpoint the change point locations, with the associated gray ribbons indicating the credible intervals. The red dashed lines describe the variation in the
                                                                                                                                                                        05-11         1.04      1.20        1.39                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        05-11
                                                                                                                                                                        05-16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-16
                                                                                                                                                                        05-21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Texas
                                                                                                                                                                        05-26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              California   05-26
                                                                                                                                                                        05-31                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           05-31
                                                                                                                                                                        06-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-05        1.02        1.29        1.62
                                                                                                                                                                        06-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-10
                                                                                                                                                                        06-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-15
                                                                                                                                                                        06-20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-20
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1.40        1.72        2.11
                                                                                                                                                                        06-25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-25
                                                                                                                                                                        06-30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           06-30
                                                                                                                                                                                      1.12      1.35        1.62
                                                                                                                                                                        07-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           07-05
                                                                                                                                                                        07-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           07-10        1.17        1.42        1.72
                                                                                                                                                                        07-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           07-15
                                                                                                                                                                                 1.2                      1.4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1.6         1.8        2.0         2.2                                                     1.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2.0            2.5             3.0
                                                                                                                                                                                                                   <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>                                                                                                                  <latexit sha1_base64="EoZD7sxdOPeZqHpo6+6kkIjJniM=">AAAB9HicbVDLSgMxFL2pr1pfVZdugkVwVWZ8oMuiG5dV7APaoWTSTBuayYxJplCGfocbF4q49WPc+Tdm2llo64HA4Zx7uSfHjwXXxnG+UWFldW19o7hZ2tre2d0r7x80dZQoyho0EpFq+0QzwSVrGG4Ea8eKkdAXrOWPbjO/NWZK80g+mknMvJAMJA84JcZKXjckZkiJSB+mPadXrjhVZwa8TNycVCBHvVf+6vYjmoRMGiqI1h3XiY2XEmU4FWxa6iaaxYSOyIB1LJUkZNpLZ6Gn+MQqfRxEyj5p8Ez9vZGSUOtJ6NvJLKRe9DLxP6+TmODaS7mME8MknR8KEoFNhLMGcJ8rRo2YWEKo4jYrpkOiCDW2p5ItwV388jJpnlXd8+rl/UWldpPXUYQjOIZTcOEKanAHdWgAhSd4hld4Q2P0gt7Rx3y0gPKdQ/gD9PkDuIOSEg==</latexit>
                                                                                                                                                                                                                     0 estimation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R00 estimation
    basic reproduction numbers R0 across segments. The posterior means and the 95% credible intervals for R0k ’s are given by red numbers.
                                                                                                                                                                                                                   RR0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     R

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         19
     cases. On the same day, the Governor announced an update regarding the executive order on
     June 26 with additional measures to slow down the spreading of COVID-19.
           In Florida, the first estimated change point was April 3. It was two days after the statewide
     stay-at-home order for Florida. We estimated that the basic reproduction number decreased
     from 2.70 to 1.28 after the change point. The second change point appeared around the middle
     of April. Starting from April 13, some counties such as Osceola county started the requirement
     of wearing a face covering while in public. It could explain the reason why we observed a slight
     decrease in R0 , from 1.28 to 0.92 with a 95% credible interval [0.73, 1.15]. The next change
     point was located around May 13, and R0 in this new stage went above 1 again, with a posterior
     mean of 1.19 and a 95% credible interval [0.96, 1.50]. We noticed that Florida entered the phase
     I reopening on May 18, which could lead to the "bounced back" situation. The fourth change
     point was around June 7, two days after the phase II reopening in Florida. Changes in the phase
     II reopening included Universal Orlando opened the parks to the general public for the first
     time in months, and we observed that R0 increased again to 1.81 with a 95% credible interval
     [1.50, 2.19]. In the last segment (after June 27) , our result revealed a slight drop in the basic
     reproduction number from 1.81 to 1.45. This change was potentially related to the consequence
     of requiring facial coverings in the four most populated cities in Florida: Tampa, Orlando, Miami,
     and Jacksonville. The face mask mandates went into effect for the four cities starting from June
     19, 20, 25, and 29, respectively. Therefore, the drop in the transmissibility at the end of June
     may be explained by the effectiveness of wearing face masks as a non-pharmaceutical practice.
           In California, we detected two change points. California was the first state to announce
     lockdown in the COVID-19 pandemic and its stay-at-home order became effective on March 19.
     Our results in change point detection could miss these early actions since the data we analyzed
     started from March 22. The first selected change point was on April 5, with the value of the
     basic reproduction number decreased dramatically when transitioning to the second segment
     (from 2.20 to 1.20). The second change point was on June 17, and we saw that R0 increased
     to 1.35 in the last segment with a 95% credible interval [1.12, 1.62]. According to California
     Governor, higher-risk businesses and venues (e.g. movie theaters, bars, gyms) were allowed to
     reopen with restrictions on June 12. Hence, increasing in the basic reproduction number could
     be the consequence of reopening. This observation was also observed in New York and Texas.
     6.2      Clustering U.S. states based on their change point locations
     We applied BayesSMILES on all 50 U.S. states. Based on the results, we seek to derive an overall
     picture of the COVID-19 dynamics across states. We summarized the temporally detected change
     points of the 50 states into common patterns, and then we labeled each state by matching its
     specific change point pattern to the common patterns. In particular, for each state, we calculated
     the marginal posterior probability of inclusion (PPI) for all time points, where the                    PBPPI for a time
     point t was calculated based on the B of MCMC samples after burn-in: pt = b=1 γt /B. Then          PPI
     we obtained the vector pPPI = (pPPI                           PPI
                                                      1 , . . . , pT ). Each entry in p
                                                                                                 PPI is a value between 0 and
     1, representing the proportion of time t selected as a change point among all iterations. Next,
     we computed the overall pattern by averaging over the vector pPPI across 50 states. We noticed
     that some time points were rarely or never selected as change points. That naturally hinted us
     to group the time points. To illustrate this, we trimmed the top 20% values of pPPI                            t    for each
     time t (Figure 6). The trimming step provided a clear pattern and highlighted the groups of
     dates that were commonly identified as change points. We observed three time spans as shown
     in Figure 6: March 27 - April 11, May 1 - May 10, and May 22 - July 3. For each state, we

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
      20                                Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
      defined its cluster label based on the corresponding change point detection results. If this state
      had at least one change point (including the confidence interval) between March 27 - April 11,
      the first element in its cluster label is "Change". Otherwise, the first element in the group label
      was set to "Stable". We repeated the same process to determine the second and third elements
      of the class label for each state. In the end, each state was assigned to a cluster label from
      "Change-Change-Change", "Change-Stable-Change", or "Stable-Change-Change".
                                 0.04
                   Trimmed PPI
                                 0.03
                                 0.02
                                 0.01
                                 0.00
                                        03-23
                                        03-26
                                        03-29
                                        04-01
                                        04-04
                                        04-07
                                        04-10
                                        04-13
                                        04-16
                                        04-19
                                        04-22
                                        04-25
                                        04-28
                                        05-01
                                        05-04
                                        05-07
                                        05-10
                                        05-13
                                        05-16
                                        05-19
                                        05-22
                                        05-25
                                        05-28
                                        05-31
                                        06-03
                                        06-06
                                        06-09
                                        06-12
                                        06-15
                                        06-18
                                        06-21
                                        06-24
                                        06-27
                                        06-30
                                        07-03
                                        07-06
                                        07-09
                                        07-12
                                        07-15
                                        07-18
      Figure 6: Case study: The averaged marginal posterior probability of inclusion (PPI) for each time point to be
      selected as a change point over all 50 U.S. states, after trimming the top 20% PPI values. The black dashed lines
      partition the whole time range into three segments: March 27 - April 11, May 1 - May 10, and May 22 - July 3.
           The map in Figure 7 colors each of the 50 states based on its cluster label, where green,
      yellow, and pink correspond to temporal patterns "Change-Stable-Change", "Change-Change-
      Change", and "Stable-Change-Change", respectively. Interestingly, three out of the four states
      we have analyzed, New York, Texas, and California, belonged to the same category, i.e. "Change-
      Stable-Change". Several other states that are also in this category include Georgia, Arizona,
      North Carolina, and Louisiana. All of these states were in the top ten states with the most
      COVID-19 confirmed cases. We noticed that the phase I statewide reopening for all these states
      occurred in mid-May (May 15 for Georgia, May 13 for Arizona, May 8 for North Carolina, May
      15 for Louisiana). Therefore, our model did not report any change points for these states between
      May 1 and May 10. The rest states in the 10 states with the most COVID-19 confirmed cases,
      including Florida, Illinois, and New Jersey, were labeled as "Change-Change-Change", and all
      of them had a change point between May 1 and May 10. As discussed in Section 6.1, Florida
      had a change point around May 13 with a confidence interval [May 8, May 18]. According to the
      Executive Order 2020-32 issued by the Illinois governors, the state entered the phase II reopening
      starting on May 1 with a modified stay-at-home order. For New Jersey, the statewide state-at-
      home order was not lifted until June 9. However, our model suggested a change point around
      the end of April with a confidence interval [April 25, May 3] with a drop in R0 from 1.11 to
      0.68 (details available at https://shuangj00.github.io/BayesSMILES/). We noticed that on
      May 3 the New Jersey Governor announced a multi-state agreement to develop a regional supply
      chain for personal protective equipment, other medical equipment and testing. This joint-state
      protective measure allowed for efficient delivery and reliability of medical equipment for states,
      and therefore best utilized the life-saving resources in the face of the COVID-19 outbreak.

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                                 It is made available under a CC-BY 4.0 International license .
                                                                            BayesSMILES                                                                                     21
                                   Clustering the US states based on change point locations
                                                                                                                      Vermont
                                                                                                                                   New Hampshire
                                                                                                                                                     Maine
                        Washington
                                                   Montana           North Dakota
                                                                                     Minnesota
                      Oregon
                                      Idaho                                                     Wisconsin                              New York
                                                                     South Dakota                               Michigan
                                                       Wyoming                                                                   Pennsylvania
                                                                                                                                                              Massachusetts
                                                                                          Iowa
                                                                        Nebraska                                         Ohio
                                                                                                                                                                Connecticut
                            Nevada                                                                   Illinois Indiana
                                            Utah                                                                                       Virginia                New Jersey
                 California                               Colorado                                                                                                Delaware
                                                                             Kansas         Missouri
                                                                                                                  Kentucky                                        Maryland
                                                                                                                                North Carolina    District of Columbia
                                                                                                              Tennessee
                                                                                                                              South Carolina    West Virginia
                                                                               Oklahoma
                                        Arizona                                              Arkansas
                                                       New Mexico
                                                                                                                           Georgia
                                                                                                    Mississippi Alabama
                                                                            Texas
                                                                                                Louisiana
                                                                                                                                     Florida
                                   Alaska
                                                                       Hawaii
                                     Cluster Label          Change-Stable-Change        Change-Change-Change            Stable-Change-Change
     Figure 7: Case study: The temporal patterns of the COVID-19 transmission dynamics based on change points
     across the 50 U.S. states. Green, yellow, and pink correspond to "Change-Stable-Change", "Change-Change-
     Change", and "Stable-Change-Change" patterns, respectively.
     6.3      Predicting new confirmed cases for U.S. states
     Reliable and accurate short-term forecasting of the new daily confirmed COVID-19 cases ĊTf
     at a future time Tf is important for both policy-makers and healthcare providers. We have
     illustrated how to use the BayesSMILES to predict the new confirmed cases in Section 4.4. The
     idea is to make the short-term forecast only based on the observed data in the last available
     segment, ensuring that only the most recent disease characteristics are utilized. We compared
     the BayesSMILES with the standard stochastic SIR model where all observed data from the first
     time point are used. We name it as FullDataSIR.
           Figure 8 shows the true values of the new daily confirmed COVID-19 cases and the predic-
     tions made by the BayesSMILES and FullDataSIR for the four major states. The 7-day forecast
     was chosen from July 20 to 26. First of all, it is observed that the predictive mean by the
     FullDataSIR tended to be larger than that from the BayesSMILES. This was because the basic
     reproduction numbers in the early stage (i.e. from late March to early April) were usually very
     large due to the lack of effective interventions. As a consequence of including those data, the
     FullDataSIR inflated the predictions. We then quantified the prediction accuracy using the mean

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
      22                                                            Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
                           (a)                                                            New York                                                                  (b)                                                    Texas
                                           2000                                                                                                                                    40000
                   Daily confirmed cases                                                                                                                   Daily confirmed cases
                                           1500                                                                                                                                    30000
                                           1000
                                                                                                                                                                                   20000
                                                                                                                                                                                                                                                               ●           ●
                                                                     ●         ●               ●                           ●                                                                                                                       ●
                                                     ●     ●                                                   ●                       ●               ●                                                                   ●           ●
                                                                                     ●               ●                                                                                             ●           ●
                                           500                                                                                   ●
                                                                                                                     ●                                                             10000     ●                                   ●           ●           ●           ●
                                                                                                                                                 ●                                                       ●           ●
                                              0
                                                                                                                                                                                       0
                                                      20              21              22              23              24          25              26                                          20          21          22          23          24          25          26
                                                   Juy             Juy             Juy             Juy             Juy         Juy             Juy                                         Juy         Juy         Juy         Juy         Juy         Juy         Juy
                                                      l               l               l               l               l           l               l                                           l           l           l           l           l           l           l
                           (c)                                                             Florida                                                                  (d)                                                   California
                                                                                                                                                                                   25000
                                           40000
                   Daily confirmed cases                                                                                                                   Daily confirmed cases
                                                                                                                                                                                   20000
                                           30000
                                                                                                                                                                                   15000
                                                                                                                                                                                                                                                                           ●
                                                                                                                                                                                                                                                               ●
                                           20000                                                                                                                                                                           ●           ●           ●
                                                                                                                                                                                                   ●           ●
                                                                                                                           ●           ●               ●                           10000
                                                                                               ●               ●
                                                               ●               ●
                                                      ●                                               ●              ●                                                                       ●           ●           ●
                                           10000                      ●               ●                                          ●               ●                                                                               ●
                                                                                                                                                                                   5000                                                      ●           ●           ●
                                                                                                                                                                                       0
                                                          20              21              22              23          24          25              26                                          20          21          22          23          24          25          26
                                                    Juy             Juy            Ju y            Juy             Juy         Juy             Juy                                         Juy         Juy         Juy         Juy         Juy         Juy         Juy
                                                       l               l              l               l               l           l               l                                           l           l           l           l           l           l           l
                                                                                                                                           ●    BayesSMILES ● FullDataSIR
      Figure 8: Case study: The 7-day forecast (between July 20 and 26) of the daily confirmed COVID-19 case
      numbers for the states of New York, Texas, Florida, and California. The red and blue circles and bars are the
      predictive means and 95% intervals by the BayesSMILES and FullDataSIR, respectively. The black thick lines
      indicate the observed truth.
      absolute percentage error (MAPE). The MAPE for the 7-day forecast is defined as
                                                                                                                                                                             7         ˙
                                                                                                         ˙                                                               1 X ĊTf − ĈTf
                                                                                               MAPE(Ċ, Ĉ)                                           =                                  ,
                                                                                                                                                                         7       Ċ T
                                                                                                                                                                           T =1      f f
      where ĊTf and Ċˆt are the observed and predicted new confirmed cases at a future time Tf .
      The smaller the MAPE value, the more accurate the prediction. The numerical summary are
      shown in Table 1. For New York, Texas, and Florida, the MAPEs from the BayesSMILES were
      much smaller than those from the FullDataSIR, suggesting a better performance. However, for
      California, the two methods were almost the same in terms of short-term forecast.
      Table 1: Case study: The mean absolute percentage errors (MAPEs) of the 7-day forecast of daily confirmed
      COVID-19 case numbers by the BayesSMILES and FullDataSIR for the states of New York, Texas, Florida, and
      California.
                                                                                                                           New York                           Texas                                    Florida                 California
                                                                   BayesSMILES                                               24.9                              38.0                                      8.9                     40.4
                                                                   FullDataSIR                                               33.0                              96.7                                     55.2                     39.9
      7      Conclusion
      In this paper, we proposed the BayesSMILES, a Bayesian segmentation model for studying the
      longitudinal epidemiological data, to analyze the transmission dynamics of an infectious disease

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         23
     such as COVID-19. Our approach includes a Bayesian Poisson segmented regression model to
     detect multiple change points from the sequence of actively daily infectious cases. Those identified
     change points correspond to latent events that significantly alter disease spreading rates, while the
     resulting segments are characterized by unique epidemiological patterns. We further describe the
     disease transmissibility for each of the segments by using a stochastic time-invariant SIR model,
     assuming the transmission rate remains the same till the next change point. Our model outputs
     a series of the basic reproduction numbers R0 ’s over stages to track the changes in spreading
     rates during a pandemic.
           We applied the BayesSMILES method to analyze the COVID-19 daily report data of 50
     U.S. states. Our results showed that the COVID-19 outbreak declined substantially after im-
     plementing stringent interventions for several states, including New York, Texas, and Florida.
     Meanwhile, our identified change points matched well with the timelines of publicly announced
     intervention strategies. In addition to that, the change in the basic reproduction numbers be-
     tween two adjacent segments might be used to quantify the effectiveness of an intervention, which
     could help us understand the impact of different control measures. Several downstream analyses
     based on the BayesSMILES results were conducted. In particular, we clustered the temporal
     patterns of the 50 U.S. states based on their change point locations, leading to an interesting
     spatial pattern related to the COVID-19 dynamics. Lastly, we demonstrated that our method
     could also improve the short-term forecasting of the new daily confirmed cases.
           In the future, we plan to extend the Poisson error structure in the change point detection
     model to a negative binomial distribution for modeling the over-dispersed count data. Further-
     more, the current BayesSMILES framework can be generalized to characterize temporal patterns
     in other epidemiological data. To do so, the segmented regression model should not be restricted
     to countable outcomes. Last but not least, due to the concern of data accuracy, the result pro-
     vided by the proposed method must be interpreted with caution. For instance, the number of
     confirmed cases is largely dependent on the test capacity and the number of recovery cases may
     suffer from under-reporting issues. How to improve the statistical power and prediction accuracy
     under those circumstances is worth investigating.
     8      Software
     We provide software in the form of R/C++ codes on GitHub https://github.com/shuangj00/
     BayesSMILES. It includes the tutorial of implementing the BayesSMILES, using U.S. state-level
     COVID-19 data as an example. Besides, we design a website https://shuangj00.github.io/
     BayesSMILES/ to summarize the inference results for the 50 U.S. states, as a supplement to
     Section 6. The website shows that 1) the detected change points for each U.S. state; 2) the
     COVID-19 transmission dynamics based on the segment-varying basic reproduction numbers
     R0 ’s, including their poster means and 95% confidence intervals.

      medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
        (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                               It is made available under a CC-BY 4.0 International license .
           24                           Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
           Table 2: Case study: The list of the identified change points by the BayesSMILES and the related supporting
           evidences for the states of New York, Texas, Florida, and California.
             Change point location
  State      (credible interval)                   Event                                                  Reference
             Mar 28 (Mar 26 - Apr 2)               14-day travel advisory                                 NBC New York (2020a)
             Apr 9 (Apr 4 - Apr 13)                First negative number for ICU admissions               Jesse Pound (2020)
New York     Apr 27 (Apr 24 - May 1)
             Jun 18 (Jun 14 - Jun 23)              Phase II reopening                                     NBC New York (2020b)
             Jun 29 (Jun 28 - Jul 4)
             Mar 28 (Mar 28 - Mar 30)              14-day travel advisory                                 Office of the Texas Governor (2020b)
             Apr 9 (Apr 8 - Apr 11)                Texas disaster declaration extension                   Ciara Rouege (2020)
             May 25 (May 22 - May 26)              Additional services and activities allowed to          Office of the Texas Governor (2020c)
                                                   open for phase II reopening
 Texas
             Jun 16 (Jun 13 - Jun 17)              The second COVID-19 wave in June                       Billy Gates (2020)
             Jun 28 (Jun 24 - Jul 3)               Multiple executive orders issued for mitigating        Office of the Texas Governor (2020d)
                                                   the disease spreading                                  Office of the Texas Governor (2020e)
                                                                                                          Office of the Texas Governor (2020a)
             Apr 3 (Apr 2 - Apr 5)                 Statewide stay-at-home order                           Klas and Contorno (2020)
             Apr 14 (Apr 10 - Apr 19)              Some counties require face coverings in public         Metevia (2020)
             May 13 (May 8 - May 18)               Phase I reopening                                      Silcox and Turco (2020)
             Jun 7 (Jun 2 - Jun 11)                Phase II reopening                                     Dobrzyn (2020)
 Florida
             Jun 27 (Jun 26 - Jul 2)               Mandatory face coverings in public for                 Frago (2020)
                                                   major cities                                           Speck and Sandoval (2020)
                                                                                                          The City Manager of the City of Miami (2020)
                                                                                                          Piggott and McLean (2020)
             Apr 5 (Apr 3 - Apr 6)
California
             Jun 17 (Jun 12 - Jun 22)              Higher-risk businesses reopening                       Sandhya Kambhampati and Krishnakumar (2020)

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         25
     9      Appendix: Approximate the multivariate normal density func-
            tion
     This section provides the details of the multivariate normal density approximation used to im-
     prove the computational efficiency in Section 4.1. We consider a general setting as follows. Let
     y be an n × 1 vector, W be an n × q matrix, X be an n × p matrix, and A = [W X] (which is
     an n × (p + q) matrix). Let Σ be a (q + p) × (q + p) diagonal matrix where the first q diagonal
     elements are h0 and the last p diagonal elements are h1 . Assume h0 , h1 , σ 2 > 0. By Woodbury
     identity and Sylvester’s determinant identity,
                  σ 2 y > (AΣA> + σ 2 I)−1 y = y > y − y > A(A> A + σ 2 Σ−1 )−1 A> y,                                           (10)
                   AΣA> + σ 2 I = σ 2n (h0 /σ 2 )W > W + I · h1 X > (h0 W W > + σ 2 I)−1 X + I ,                                (11)
     where | · | denotes the matrix determinant and I is a diagonal matrix of proper dimension. Define
                                    P = I − W (W > W )−1 W > ,               X̃ = P X,              ỹ = P y,
     where X̃ (respectively ỹ) is the residual after regressing out W from X (respectively y). Zhou
     and Guan (2018) showed that the expressions in (10) and (11) can be further simplified when
     h0 → ∞. The conclusions are summarized below with the proof available in the supplement of
     Zhou and Guan (2018).
     Lemma 1. Let y, W, X, A, Σ, ỹ, X̃, σ 2 , h0 , h1 be as defined above. Then,
                         lim σ 2 y > (AΣA> + σ 2 I)−1 y = ỹ > ỹ − ỹ > X̃(X̃ > X̃ + (σ 2 /h1 )I)−1 X̃ > ỹ,                   (12)
                        h0 ↑∞
     and
                                                   AΣA> + σ 2 I
                                           lim                         = (h1 /σ 2 )X̃ > X̃ + I .                                (13)
                                          h0 ↑∞ |h0 W W > + σ 2 I|
            The conclusions in the lemma above can be used to improve the computational efficiency
     for approximating the multivariate normal probability density function (p.d.f.) in our model.
     Within each segment k we assumed log α· = Xk βk + k . Under the prior specification discussed
     in Section 3.3, we have log α· ∼ MN(0, Xk Σ0 XkT + σ 2 I), and the corresponding p.d.f. for log α·
     is:
                                                                                                                        
                                −nk /2             T       2 −1/2             1         >               T      2 −1
         p(log α· ) = (2π)               Xk Σ0 Xk + σ I             exp − log α· (Xk Σ0 Xk + σ I) log α· , (14)
                                                                              2
     where nk is the segment length. Next, we simplify the calculation of Xk Σ0 XkT + σ 2 I and
     (Xk Σ0 XkT + σ 2 I)−1 by using Lemma 1. Consider X = (t1 , . . . , tnk )> and W as a column                             vector
                                                                                                                  h0 0
                                                                                                                       
     of 1’s with length nk . The vector y in our case matches log α· , and Σ = Σ0 = 0 h1 . Lemma 1
     states that the inverse and determinant calculation of an nk × nk matrix can be reduced to that
     of a p × p matrix, and in our case p = 1 (since the regression model only includes "time" as a
     covariate except the intercept term). Therefore, the computational benefit could be significant
     when nk was large. We first derive the formula of P as follows,
                                                                         1 − n1      − n1     . . . − n1
                                                                                                              
                                                                        −1               1                 1 
                                                    >     −1     >      n 1 − n . . . −n 
                               P = I − W (W W ) W =  .                               ..      ..          ..  .
                                                                        ..            .          .        . 
                                                                          − n1       − n1     ... 1 −        1
                                                                                                             n

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                          It is made available under a CC-BY 4.0 International license .
     26                            Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     Next, according to Equation (12), Xk Σ0 XkT + σ 2 I can be approximated by (h1 /σ 2 )X̃ > X̃ + I ×
      h0 W W > + σ 2 I when h0 → +∞. In particular, we can derive
                                         X̃ > = (P X)> = t1 − t̄ t2 − t̄ . . . tnk − t̄ .
                                                                                                     
     Therefore,
                                                                                                                   
                                                                                                            t1 − t̄
                                                                                                          t2 − t̄ 
                                                                                                                  
                   (h1 /σ 2 )X̃ > X̃ + I = |(h1 /σ 2 ) t1 − t̄ t2 − t̄ . . . tnk               − t̄ ×  .  + I|
                                                                                                          .. 
                                                                                                           tnk − t̄
                                                              Xnk
                                                = (h1 /σ 2 )      (ti − t̄)2 + 1.                                                 (15)
                                                              i=1
     To calculate h0 W W > + σ 2 I , note that W W > is an nk × nk matrix, and we can derive that
                                                                                            σ2
                                                 h0 W W > + σ 2 I = hn0 k W W > +               I .                               (16)
                                                                                            h0
     According to Sylvester’s determinant lemma, we have
                                                                          2 nk                        2 nk
                               >      σ2                h0 >               σ                    nk h0          σ
                       WW + I = I + 2W W ×                                          = 1+ 2                ×              .
                                      h0                σ                   h0                    σ            h0
     Therefore, the formula in Equation (16) equals the following,
                                                                         2 nk                                      
                                                                  nk h0         σ                                nk h0
                    h0 W W > + σ 2 I = hn0 k × 1 + 2                       ×             = (σ 2 )nk × 1 + 2                .      (17)
                                                                   σ            h0                                 σ
     Combining the results in Equations (15) and (17), we can approximate the matrix determinant
     in (14) as follows when h0 → ∞,
                                                         −1/2                        σ −nk
                                  Xk Σ0 XkT + σ 2 I             ≈q              q                              .                  (18)
                                                                      nk h0         h1 Pnk               2
                                                                        σ2
                                                                             +1     σ2     i=1 (ti − t̄) + 1
     Next, it is straightforward to derive the formula in the exponent part in Equation (14) using the
     result in Equation (12). In particular, we can derive:
                            ỹ > = (P y)> = log α>
                                                                                                                 
                                                         · P = log α1 − log α· . . . log αnk − log α· ,
                                                  −1          nk
                                                                                    !−1
                                               2                                  2
                             
                                             σ                X                 σ
                                X̃ > X̃ + I             =         (ti − t̄)2 +            ,
                                             h1                                 h1
                                                              i=1
                                       X nk
                            ỹ > X̃ =         (ti − t̄)(log αi − log α· ).
                                        i=1
     Then we approximate the exponent part in Equation (14) as follows under the condition of
     h0 → ∞,
                                                                          nk                             Pnk                               2 !
        1                                                         1                                         i=1 (ti − t̄)(log αi − log α· )
                                                                         X
                  >               T      2 −1                                                     2
     − log α· (Xk Σ0 Xk + σ I) log α· ≈ − 2                                  (log αi − log α· ) −              Pnk                 σ2
                                                                                                                                                .
        2                                                        2σ                                                             2
                                                                                                                   i=1 (ti − t̄) + h1
                                                                         i=1
                                                                                                                                  (19)

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         27
     We further introduce the following notation,
                      X nk                           Xnk                                   X nk
             Stt =         (ti − t̄)2 ,     Sαα =         (log αi − log α· )2 ,    Sαt =         (log αi − log α· )(ti − t̄).
                       i=1                           i=1                                    i=1
     By combining the approximations in (18) and (19), we obtain that
                                                                                        (                       )!
                                                (2π)−nk /2 σ −nk                    1                     2
                                                                                                         Sαt
                         p(log α· ) ≈ q                  q              exp − 2 Sαα −                        σ2
                                                                                                                   .
                                               nk h0
                                                     + 1    h1
                                                               S   +  1           2σ                S  tt +
                                                σ 2         σ 2 tt                                           h1
     In practice, the condition of h0 → ∞ is satisfied when h0  h1 . We set h0 = 10, 000 and h1 = 10
     and the approximation accuracy is desirable.

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
     28                           Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
     References
     Akiyama MJ, Spaulding AC, Rich JD (2020).                                   Flattening the curve for incarcerated
        populations—COVID-19 in jails and prisons. New England Journal of Medicine, 382(22):
        2075–2077.
     Alvarez FE, Argente D, Lippi F (2020). A simple planning problem for COVID-19 lockdown.
        Technical report, National Bureau of Economic Research.
     Billy Gates AGYC Matthew Prendergast (2020). Austin health leaders concerned about
        possible 2nd COVID-19 wave in June.                             kxan.       URL: https://www.kxan.com/news/
        austin-public-health-to-give-covid-19-update-at-9-a-m/, accessed 2020-05-27.
     Chen YC, Lu PE, Chang CS (2020). A Time-dependent SIR model for COVID-19. arXiv preprint
        arXiv:2003.00122.
     Chowell G, Castillo-Chavez C, Fenimore PW, Kribs-Zaleta CM, Arriola L, Hyman JM (2004).
        Model parameters and outbreak control for SARS. Emerging Infectious Diseases, 10(7): 1258.
     Ciara Rouege (2020).                       Abbott extends Texas disaster declaration | Here’s what
        that means.                    KHOU.                URL: https://www.khou.com/article/news/health/
        coronavirus/gov-abbott-extends-disaster-declaration-another-30-days/
        285-9e494ee3-5ea5-48d9-bf35-b8c4b88f5126, accessed 2020-04-12.
     Cooper I, Mondal A, Antonopoulos CG (2020). A SIR model assumption for the spread of
        COVID-19 in different communities. Chaos, Solitons & Fractals, 139: 110057.
     Dehning J, Zierenberg J, Spitzner FP, Wibral M, Neto JP, Wilczek M, et al. (2020). Inferring
        change points in the spread of COVID-19 reveals the effectiveness of interventions. Science.
     Dobrzyn E (2020). Gov. Ron DeSantis says most of Florida will enter phase 2 of reopening
        Friday. Click Orlando. URL: https://www.clickorlando.com/news/local/2020/06/03/
        gov-ron-desantis-says-most-of-florida-will-enter-phase-2-of-reopening-friday/,
        accessed 2020-06-03.
     Dong E, Du H, Gardner L (2020). An interactive web-based dashboard to track COVID-19 in
        real time. The Lancet Infectious Diseases, 20(5): 533–534.
     Edwards AW, Cavalli-Sforza LL (1965). A method for cluster analysis. Biometrics, 362–375.
     Frago C (2020). Tampa’s mask order went into effect Friday. Here’s what you need to
        know. Tampa Bay News. URL: https://www.tampabay.com/news/tampa/2020/06/19/
        tampas-mask-order-goes-into-effect-today-heres-what-you-need-to-know/, accessed
        2020-06-19.
     Giordano G, Blanchini F, Bruno R, Colaneri P, Di Filippo A, Di Matteo A, et al. (2020). Mod-
        elling the COVID-19 epidemic and implementation of population-wide interventions in Italy.
        Nature Medicine, 1–6.
     Gostic KM, McGough L, Baskerville E, Abbott S, Joshi K, Tedijanto C, et al. (2020). Practical
        considerations for measuring the effective reproductive number,Rt. medRxiv.
     Hinkley DV (1970). Inference about the change-point in a sequence of random variables.
     Hubert L, Arabie P (1985). Comparing partitions. Journal of Classification, 2(1): 193–218.
     Jen T, Gupta AK (1987). On testing homogeneity of variances for Gaussian models. Journal of
        Statistical Computation and Simulation, 27(2): 155–173.
     Jesse Pound (2020). New York posts negative net change in ICU admissions for first
        time since coronavirus outbreak. CNBC. URL: https://www.cnbc.com/2020/04/10/
        ny-has-first-negative-net-change-in-icu-admissions-since-coronavirus-outbreak.
        html, accessed 2020-04-10.
     Kantner M, Koprucki T (2020). Beyond just “flattening the curve”: Optimal control of epidemics

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         29
        with purely non-pharmaceutical interventions. Journal of Mathematics in Industry, 10(1):
        1–23.
     Kermack WO, McKendrick AG (1927). A contribution to the mathematical theory of epidemics.
        Proceedings of the royal society of london. Series A, Containing papers of a mathematical and
        physical character, 115(772): 700–721.
     Killick R, Eckley I (2014). changepoint: An R package for changepoint analysis. Journal of
        Statistical Software, 58(3): 1–19.
     Killick R, Fearnhead P, Eckley IA (2012). Optimal detection of changepoints with a linear
        computational cost. Journal of the American Statistical Association, 107(500): 1590–1598.
     Klas ME, Contorno S (2020). Florida Gov. Ron DeSantis issues statewide stay-at-home
        order. Tampa Bay News. URL: https://www.tampabay.com/news/health/2020/04/01/
        florida-gov-ron-desantis-issues-statewide-stay-at-home-order/, accessed 2020-04-
        01.
     Lloyd-Smith JO, Galvani AP, Getz WM (2003). Curtailing transmission of severe acute respi-
        ratory syndrome within a community and its hospital. Proceedings of the Royal Society of
        London. Series B: Biological Sciences, 270(1528): 1979–1989.
     Metevia T (2020).                         Osceola County now requires face coverings in public.
        Click Orlando.                      URL: https://www.clickorlando.com/news/local/2020/04/10/
        watch-live-osceola-county-officials-provide-update-on-covid-19-pandemic/,
        accessed 2020-04-13.
     NBC New York (2020a). CDC Issues 14-Day Travel Advisory for New York, New Jer-
        sey, Connecticut. NBC New York. URL: https://www.nbcnewyork.com/news/local/
        even-with-relief-bill-passed-no-rest-for-ny-as-cuomo-says-peak-of-crisis-still-yet-to-come/
        2348306/, accessed 2020-03-28.
     NBC New York (2020b).                                    NYC Moves to Phase II in Biggest Re-
        opening          Step        Yet;        State       Daily     Virus       Deaths         Plunge     to    New        Low.
        NBC           New           York.                     URL:         https://www.nbcnewyork.com/news/local/
        nyc-reopening-hits-highest-gear-yet-as-shops-outdoor-dining-and-playgrounds-return-monday/
        2477627/, accessed 2020-06-22.
     Office of the Texas Governor (2020a).                                           A proclamation amending Ex-
        ecutive         Order         GA-28         by       Office     of     the       Texas         Governor.              URL:
        https://open.texas.gov/uploads/files/organization/opentexas/
        DISASTER-proclamation-amending-GA-28-mass-gatherings-IMAGE-07-02-2020.pdf,
        accessed 2020-07-02.
     Office of the Texas Governor (2020b).                                      Executive Order GA-11 by Office
        of the Texas Governor.                                  URL: https://www.nbcnewyork.com/news/local/
        nyc-reopening-hits-highest-gear-yet-as-shops-outdoor-dining-and-playgrounds-return-monday/
        2477627/, accessed 2020-03-26.
     Office of the Texas Governor (2020c). Executive Order GA-24 by Office of the Texas Gov-
        ernor. URL: https://gov.texas.gov/uploads/files/press/DISASTER_Adding_Covered_
        Services_to_GA-23_No_2_COVID-19.pdf, accessed 2020-05-26.
     Office of the Texas Governor (2020d). Executive Order GA-28 by Office of the Texas Gover-
        nor. URL: https://gov.texas.gov/uploads/files/press/EO-GA-28_targeted_response_
        to_reopening_COVID-19.pdf, accessed 2020-06-26.
     Office of the Texas Governor (2020e). Executive Order GA-29 by Office of the Texas
        Governor.             URL: https://open.texas.gov/uploads/files/organization/opentexas/

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
     30                           Shuang Jiang, Quan Zhou, Xiaowei Zhan, and Qiwei Li
        EO-GA-29-use-of-face-coverings-during-COVID-19-IMAGE-07-02-2020.pdf, accessed
        2020-07-02.
     Pedersen MG, Meneghini M (2020). Quantifying undetected COVID-19 cases and effects of
        containment measures in italy. ResearchGate Preprint (online 21 March 2020) DOI, 10.
     Piggott J, McLean J (2020).                          Jacksonville changes course, issues face mask man-
        date.            News4JAX.                URL: https://www.news4jax.com/news/local/2020/06/29/
        jacksonville-issues-face-mask-mandate/, accessed 2020-06-29.
     Rand WM (1971). Objective criteria for the evaluation of clustering methods. Journal of the
        American Statistical Association, 66(336): 846–850.
     Riley S, Fraser C, Donnelly CA, Ghani AC, Abu-Raddad LJ, Hedley AJ, et al. (2003). Trans-
        mission dynamics of the etiological agent of SARS in Hong Kong: impact of public health
        interventions. Science, 300(5627): 1961–1966.
     Sandhya Kambhampati MM, Krishnakumar P (2020).                                        Which California counties are
        reopening?                   Los Angeles Times.                 URL: https://www.latimes.com/projects/
        california-coronavirus-cases-tracking-outbreak/reopening-across-counties/.
     Santos JM, Embrechts M (2009). On the use of the adjusted rand index as a metric for evaluating
        supervised classification. In: International Conference on Artificial Neural Networks, 175–184.
        Springer.
     Sen A, Srivastava MS (1975). On tests for detecting change in mean. The Annals of Statistics,
        98–108.
     Silcox F, Turco R (2020).                       Florida Businesses Ready for Full Phase One Reopen-
        ing. Bay News. URL: https://www.baynews9.com/fl/tampa/coronavirus/2020/05/18/
        ongoing-coronavirus-coverage, accessed 2020-05-18.
     Song PX, Wang L, Zhou Y, He J, Zhu B, Wang F, et al. (2020). An epidemiological forecast
        model and software assessing interventions on COVID-19 epidemic in China. medRxiv.
     Speck E, Sandoval E (2020).                                       Orange County residents will be re-
        quired to wear face masks under new executive order.                                                         Click Or-
        lando.                          URL:          https://www.clickorlando.com/news/local/2020/06/18/
        orange-county-residents-will-be-required-to-wear-face-masks-under-new-executive-order/,
        accessed 2020-06-18.
     Steuer R, Kurths J, Daub CO, Weise J, Selbig J (2002). The mutual information: detecting and
        evaluating dependencies between variables. Bioinformatics, 18(suppl_2): S231–S240.
     Tadesse MG, Sha N, Vannucci M (2005). Bayesian variable selection in clustering high-
        dimensional data. Journal of the American Statistical Association, 100(470): 602–617.
     The City Manager of the City of Miami (2020). City Mandates Facial Coverings in Public; Civil
        Penalties Approved. URL: https://www.miamigov.com/files/sharedassets/public/news/
        2020/0625-emergency-order-20-16.pdf, accessed 2020-06-25.
     Toda AA (2020). Susceptible-infected-recovered (SIR) Dynamics of COVID-19 and Economic
        Impact. arXiv preprint arXiv:2003.11221.
     Vehtari A, Gelman A, Gabry J (2017). Practical Bayesian model evaluation using leave-one-out
        cross-validation and WAIC. Statistics and Computing, 27(5): 1413–1432.
     Waqas M, Farooq M, Ahmad R, Ahmad A (2020). Analysis and Prediction of COVID-19 Pan-
        demic in Pakistan using Time-dependent SIR Model. arXiv preprint arXiv:2005.02353.
     Weitz JS, Beckett SJ, Coenen AR, Demory D, Dominguez-Mirazo M, Dushoff J, et al. (2020).
        Modeling shield immunity to reduce COVID-19 epidemic spread. Nature Medicine, 1–6.
     Zhou Q, Guan Y (2018). On the null distribution of bayes factors in linear regression. Journal

medRxiv preprint doi: https://doi.org/10.1101/2020.10.06.20208132.this version posted October 8, 2020. The copyright holder for this preprint
  (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
                                         It is made available under a CC-BY 4.0 International license .
                                                               BayesSMILES                                                         31
        of the American Statistical Association, 113(523): 1362–1371.
     Zhou T, Ji Y (2020). Semiparametric Bayesian Inference for the Transmission Dynamics of
        COVID-19 with a State-Space Model. arXiv preprint arXiv:2006.05581.
